<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2 Fundamentals of Linear Regression | Recoding Introduction to Mediation, Moderation, and Conditional Process Analysis</title>
  <meta name="description" content="This project is an effort to connect his Hayes’s conditional process analysis work with the Bayesian paradigm. Herein I refit his models with my favorite R package for Bayesian regression, Bürkner’s brms, and use the tidyverse for data manipulation and plotting." />
  <meta name="generator" content="bookdown 0.12 and GitBook 2.6.7" />

  <meta property="og:title" content="2 Fundamentals of Linear Regression | Recoding Introduction to Mediation, Moderation, and Conditional Process Analysis" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This project is an effort to connect his Hayes’s conditional process analysis work with the Bayesian paradigm. Herein I refit his models with my favorite R package for Bayesian regression, Bürkner’s brms, and use the tidyverse for data manipulation and plotting." />
  <meta name="github-repo" content="ASKURZ/recoding-Hayes-2018" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2 Fundamentals of Linear Regression | Recoding Introduction to Mediation, Moderation, and Conditional Process Analysis" />
  <meta name="twitter:site" content="@SolomonKurz" />
  <meta name="twitter:description" content="This project is an effort to connect his Hayes’s conditional process analysis work with the Bayesian paradigm. Herein I refit his models with my favorite R package for Bayesian regression, Bürkner’s brms, and use the tidyverse for data manipulation and plotting." />
  

<meta name="author" content="A Solomon Kurz" />


<meta name="date" content="2019-12-20" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="introduction.html">
<link rel="next" href="the-simple-mediation-model.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#why-this"><i class="fa fa-check"></i>Why this?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#my-assumptions-about-you"><i class="fa fa-check"></i>My assumptions about you</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#how-to-use-and-understand-this-project"><i class="fa fa-check"></i>How to use and understand this project</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#times-change-and-so-do-we"><i class="fa fa-check"></i>Times change and so do we</a></li>
</ul></li>
<li class="part"><span><b>I FUNDAMENTALS</b></span></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#references"><i class="fa fa-check"></i>References</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#session-info"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="fundamentals-of-linear-regression.html"><a href="fundamentals-of-linear-regression.html"><i class="fa fa-check"></i><b>2</b> Fundamentals of Linear Regression</a><ul>
<li class="chapter" data-level="2.1" data-path="fundamentals-of-linear-regression.html"><a href="fundamentals-of-linear-regression.html#correlation-and-prediction"><i class="fa fa-check"></i><b>2.1</b> Correlation and prediction</a></li>
<li class="chapter" data-level="2.2" data-path="fundamentals-of-linear-regression.html"><a href="fundamentals-of-linear-regression.html#the-simple-linear-regression-model"><i class="fa fa-check"></i><b>2.2</b> The simple linear regression model</a><ul>
<li class="chapter" data-level="2.2.1" data-path="fundamentals-of-linear-regression.html"><a href="fundamentals-of-linear-regression.html#interpretation-of-the-constant-and-regression-coefficient."><i class="fa fa-check"></i><b>2.2.1</b> Interpretation of the constant and regression coefficient.</a></li>
<li class="chapter" data-level="2.2.2" data-path="fundamentals-of-linear-regression.html"><a href="fundamentals-of-linear-regression.html#the-standardized-regression-model."><i class="fa fa-check"></i><b>2.2.2</b> The standardized regression model.</a></li>
<li class="chapter" data-level="2.2.3" data-path="fundamentals-of-linear-regression.html"><a href="fundamentals-of-linear-regression.html#simple-linear-regression-with-a-dichotomous-antecedent-variable."><i class="fa fa-check"></i><b>2.2.3</b> Simple linear regression with a dichotomous antecedent variable.</a></li>
<li class="chapter" data-level="2.2.4" data-path="fundamentals-of-linear-regression.html"><a href="fundamentals-of-linear-regression.html#a-note-on-symbolic-representations."><i class="fa fa-check"></i><b>2.2.4</b> A note on symbolic representations.</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="fundamentals-of-linear-regression.html"><a href="fundamentals-of-linear-regression.html#alternative-explanations-for-association"><i class="fa fa-check"></i><b>2.3</b> Alternative explanations for association</a></li>
<li class="chapter" data-level="2.4" data-path="fundamentals-of-linear-regression.html"><a href="fundamentals-of-linear-regression.html#multiple-linear-regression"><i class="fa fa-check"></i><b>2.4</b> Multiple linear regression</a><ul>
<li class="chapter" data-level="2.4.1" data-path="fundamentals-of-linear-regression.html"><a href="fundamentals-of-linear-regression.html#the-standardized-regression-model.-1"><i class="fa fa-check"></i><b>2.4.1</b> The standardized regression model.</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="fundamentals-of-linear-regression.html"><a href="fundamentals-of-linear-regression.html#measures-of-model-fit"><i class="fa fa-check"></i><b>2.5</b> Measures of model fit</a></li>
<li class="chapter" data-level="2.6" data-path="fundamentals-of-linear-regression.html"><a href="fundamentals-of-linear-regression.html#statistical-inference"><i class="fa fa-check"></i><b>2.6</b> Statistical inference</a><ul>
<li class="chapter" data-level="2.6.1" data-path="fundamentals-of-linear-regression.html"><a href="fundamentals-of-linear-regression.html#testing-a-null-hypothesis."><i class="fa fa-check"></i><b>2.6.1</b> Testing a null hypothesis.</a></li>
<li class="chapter" data-level="2.6.2" data-path="fundamentals-of-linear-regression.html"><a href="fundamentals-of-linear-regression.html#interval-estimation."><i class="fa fa-check"></i><b>2.6.2</b> Interval estimation.</a></li>
<li class="chapter" data-level="2.6.3" data-path="fundamentals-of-linear-regression.html"><a href="fundamentals-of-linear-regression.html#testing-a-hypothesis-about-a-set-of-antecedent-variables."><i class="fa fa-check"></i><b>2.6.3</b> Testing a hypothesis about a set of antecedent variables.</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="fundamentals-of-linear-regression.html"><a href="fundamentals-of-linear-regression.html#multicategorical-antecedent-variables"><i class="fa fa-check"></i><b>2.7</b> Multicategorical antecedent variables</a></li>
<li class="chapter" data-level="2.8" data-path="fundamentals-of-linear-regression.html"><a href="fundamentals-of-linear-regression.html#assumptions-for-interpretation-and-statistical-inference"><i class="fa fa-check"></i><b>2.8</b> Assumptions for interpretation and statistical inference</a><ul>
<li class="chapter" data-level="2.8.1" data-path="fundamentals-of-linear-regression.html"><a href="fundamentals-of-linear-regression.html#linearity."><i class="fa fa-check"></i><b>2.8.1</b> Linearity.</a></li>
<li class="chapter" data-level="2.8.2" data-path="fundamentals-of-linear-regression.html"><a href="fundamentals-of-linear-regression.html#normality."><i class="fa fa-check"></i><b>2.8.2</b> Normality.</a></li>
<li class="chapter" data-level="2.8.3" data-path="fundamentals-of-linear-regression.html"><a href="fundamentals-of-linear-regression.html#homoscedasticity."><i class="fa fa-check"></i><b>2.8.3</b> Homoscedasticity.</a></li>
<li class="chapter" data-level="2.8.4" data-path="fundamentals-of-linear-regression.html"><a href="fundamentals-of-linear-regression.html#independence."><i class="fa fa-check"></i><b>2.8.4</b> Independence.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="fundamentals-of-linear-regression.html"><a href="fundamentals-of-linear-regression.html#reference"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="fundamentals-of-linear-regression.html"><a href="fundamentals-of-linear-regression.html#session-info-1"><i class="fa fa-check"></i>Session info</a></li>
<li class="chapter" data-level="" data-path="fundamentals-of-linear-regression.html"><a href="fundamentals-of-linear-regression.html#footnote"><i class="fa fa-check"></i>Footnote</a></li>
</ul></li>
<li class="part"><span><b>II MEDIATION ANALYSIS</b></span></li>
<li class="chapter" data-level="3" data-path="the-simple-mediation-model.html"><a href="the-simple-mediation-model.html"><i class="fa fa-check"></i><b>3</b> The Simple Mediation Model</a><ul>
<li class="chapter" data-level="3.1" data-path="the-simple-mediation-model.html"><a href="the-simple-mediation-model.html#the-simple-mediation-model-1"><i class="fa fa-check"></i><b>3.1</b> The simple mediation model</a></li>
<li class="chapter" data-level="3.2" data-path="the-simple-mediation-model.html"><a href="the-simple-mediation-model.html#estimation-of-the-direce-indirect-and-total-effects-of-x"><i class="fa fa-check"></i><b>3.2</b> Estimation of the direce, indirect, and total effects of <span class="math inline">\(X\)</span></a></li>
<li class="chapter" data-level="3.3" data-path="the-simple-mediation-model.html"><a href="the-simple-mediation-model.html#example-with-dichotomous-x-the-influence-of-presumed-media-influence"><i class="fa fa-check"></i><b>3.3</b> Example with dichotomous <span class="math inline">\(X\)</span>: The influence of presumed media influence</a><ul>
<li class="chapter" data-level="3.3.1" data-path="the-simple-mediation-model.html"><a href="the-simple-mediation-model.html#estimation-of-the-model-in-process-for-spss-and-sas."><i class="fa fa-check"></i><b>3.3.1</b> <del>Estimation of the model in PROCESS for SPSS and SAS.</del></a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="the-simple-mediation-model.html"><a href="the-simple-mediation-model.html#statistical-inference-1"><i class="fa fa-check"></i><b>3.4</b> Statistical inference</a><ul>
<li class="chapter" data-level="3.4.1" data-path="the-simple-mediation-model.html"><a href="the-simple-mediation-model.html#inference-about-the-total-effect-of-x-on-y."><i class="fa fa-check"></i><b>3.4.1</b> Inference about the total effect of <span class="math inline">\(X\)</span> on <span class="math inline">\(Y\)</span>.</a></li>
<li class="chapter" data-level="3.4.2" data-path="the-simple-mediation-model.html"><a href="the-simple-mediation-model.html#inference-about-the-direct-effect-of-x-on-y."><i class="fa fa-check"></i><b>3.4.2</b> Inference about the direct effect of <span class="math inline">\(X\)</span> on <span class="math inline">\(Y\)</span>.</a></li>
<li class="chapter" data-level="3.4.3" data-path="the-simple-mediation-model.html"><a href="the-simple-mediation-model.html#inference-about-the-indirect-of-x-on-y-through-m."><i class="fa fa-check"></i><b>3.4.3</b> Inference about the indirect of <span class="math inline">\(X\)</span> on <span class="math inline">\(Y\)</span> through <span class="math inline">\(M\)</span>.</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="the-simple-mediation-model.html"><a href="the-simple-mediation-model.html#an-example-with-continuous-x-economic-stress-among-small-business-owners"><i class="fa fa-check"></i><b>3.5</b> An example with continuous <span class="math inline">\(X\)</span>: Economic stress among small-business owners</a></li>
<li class="chapter" data-level="" data-path="the-simple-mediation-model.html"><a href="the-simple-mediation-model.html#reference-1"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="the-simple-mediation-model.html"><a href="the-simple-mediation-model.html#session-info-2"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="causal-steps-confounding-and-causal-order.html"><a href="causal-steps-confounding-and-causal-order.html"><i class="fa fa-check"></i><b>4</b> Causal Steps, Confounding, and Causal Order</a><ul>
<li class="chapter" data-level="4.1" data-path="causal-steps-confounding-and-causal-order.html"><a href="causal-steps-confounding-and-causal-order.html#what-about-barron-and-kenny"><i class="fa fa-check"></i><b>4.1</b> What about Barron and Kenny?</a></li>
<li class="chapter" data-level="4.2" data-path="causal-steps-confounding-and-causal-order.html"><a href="causal-steps-confounding-and-causal-order.html#confounding-and-causal-order"><i class="fa fa-check"></i><b>4.2</b> Confounding and causal order</a><ul>
<li class="chapter" data-level="4.2.1" data-path="causal-steps-confounding-and-causal-order.html"><a href="causal-steps-confounding-and-causal-order.html#accounting-for-confounding-and-epiphenomenal-association."><i class="fa fa-check"></i><b>4.2.1</b> Accounting for confounding and epiphenomenal association.</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="causal-steps-confounding-and-causal-order.html"><a href="causal-steps-confounding-and-causal-order.html#effect-size"><i class="fa fa-check"></i><b>4.3</b> Effect size</a><ul>
<li class="chapter" data-level="4.3.1" data-path="causal-steps-confounding-and-causal-order.html"><a href="causal-steps-confounding-and-causal-order.html#the-partially-standardized-effect."><i class="fa fa-check"></i><b>4.3.1</b> The partially standardized effect.</a></li>
<li class="chapter" data-level="4.3.2" data-path="causal-steps-confounding-and-causal-order.html"><a href="causal-steps-confounding-and-causal-order.html#the-completely-standardized-effect."><i class="fa fa-check"></i><b>4.3.2</b> The completely standardized effect.</a></li>
<li class="chapter" data-level="4.3.3" data-path="causal-steps-confounding-and-causal-order.html"><a href="causal-steps-confounding-and-causal-order.html#some-problematic-measures-only-for-indirect-effects."><i class="fa fa-check"></i><b>4.3.3</b> Some (problematic) measures only for indirect effects.</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="causal-steps-confounding-and-causal-order.html"><a href="causal-steps-confounding-and-causal-order.html#statistical-power"><i class="fa fa-check"></i><b>4.4</b> Statistical power</a></li>
<li class="chapter" data-level="4.5" data-path="causal-steps-confounding-and-causal-order.html"><a href="causal-steps-confounding-and-causal-order.html#multiple-xs-or-ys-analyze-separately-or-simultaneously"><i class="fa fa-check"></i><b>4.5</b> Multiple <span class="math inline">\(X\)</span>s or <span class="math inline">\(Y\)</span>s: Analyze separately or simultaneously?</a><ul>
<li class="chapter" data-level="4.5.1" data-path="causal-steps-confounding-and-causal-order.html"><a href="causal-steps-confounding-and-causal-order.html#multiple-x-variables."><i class="fa fa-check"></i><b>4.5.1</b> Multiple <span class="math inline">\(X\)</span> variables.</a></li>
<li class="chapter" data-level="4.5.2" data-path="causal-steps-confounding-and-causal-order.html"><a href="causal-steps-confounding-and-causal-order.html#estimation-of-a-model-with-multiple-x-variables-in-process-brms."><i class="fa fa-check"></i><b>4.5.2</b> Estimation of a model with multiple <span class="math inline">\(X\)</span> variables in <del>PROCESS</del> brms.</a></li>
<li class="chapter" data-level="4.5.3" data-path="causal-steps-confounding-and-causal-order.html"><a href="causal-steps-confounding-and-causal-order.html#multiple-y-variables."><i class="fa fa-check"></i><b>4.5.3</b> Multiple <span class="math inline">\(Y\)</span> variables.</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="causal-steps-confounding-and-causal-order.html"><a href="causal-steps-confounding-and-causal-order.html#chapter-summary"><i class="fa fa-check"></i><b>4.6</b> Chapter summary</a></li>
<li class="chapter" data-level="" data-path="causal-steps-confounding-and-causal-order.html"><a href="causal-steps-confounding-and-causal-order.html#references-1"><i class="fa fa-check"></i>References</a></li>
<li class="chapter" data-level="" data-path="causal-steps-confounding-and-causal-order.html"><a href="causal-steps-confounding-and-causal-order.html#session-info-3"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="more-than-one-mediator.html"><a href="more-than-one-mediator.html"><i class="fa fa-check"></i><b>5</b> More Than One Mediator</a><ul>
<li class="chapter" data-level="5.1" data-path="more-than-one-mediator.html"><a href="more-than-one-mediator.html#the-parallel-multiple-mediator-model"><i class="fa fa-check"></i><b>5.1</b> The parallel multiple mediator model</a><ul>
<li class="chapter" data-level="5.1.1" data-path="more-than-one-mediator.html"><a href="more-than-one-mediator.html#direct-and-indirect-effects-in-a-parallel-multiple-mediator-model."><i class="fa fa-check"></i><b>5.1.1</b> Direct and indirect effects in a parallel multiple mediator model.</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="more-than-one-mediator.html"><a href="more-than-one-mediator.html#example-using-the-presumed-media-influence-study"><i class="fa fa-check"></i><b>5.2</b> Example using the presumed media influence study</a></li>
<li class="chapter" data-level="5.3" data-path="more-than-one-mediator.html"><a href="more-than-one-mediator.html#statistical-inference-2"><i class="fa fa-check"></i><b>5.3</b> Statistical inference</a><ul>
<li class="chapter" data-level="5.3.1" data-path="more-than-one-mediator.html"><a href="more-than-one-mediator.html#inference-about-the-direct-and-total-effects."><i class="fa fa-check"></i><b>5.3.1</b> Inference about the direct and total effects.</a></li>
<li class="chapter" data-level="5.3.2" data-path="more-than-one-mediator.html"><a href="more-than-one-mediator.html#inference-about-specific-indirect-effects."><i class="fa fa-check"></i><b>5.3.2</b> Inference about specific indirect effects.</a></li>
<li class="chapter" data-level="5.3.3" data-path="more-than-one-mediator.html"><a href="more-than-one-mediator.html#pairwise-comparisons-between-specific-indirect-effects."><i class="fa fa-check"></i><b>5.3.3</b> Pairwise comparisons between specific indirect effects.</a></li>
<li class="chapter" data-level="5.3.4" data-path="more-than-one-mediator.html"><a href="more-than-one-mediator.html#inference-about-the-total-indirect-effect."><i class="fa fa-check"></i><b>5.3.4</b> Inference about the total indirect effect.</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="more-than-one-mediator.html"><a href="more-than-one-mediator.html#the-serial-multiple-mediator-model"><i class="fa fa-check"></i><b>5.4</b> The serial multiple mediator model</a><ul>
<li class="chapter" data-level="5.4.1" data-path="more-than-one-mediator.html"><a href="more-than-one-mediator.html#direct-and-indirect-effects-in-a-serial-multiple-mediator-model."><i class="fa fa-check"></i><b>5.4.1</b> Direct and indirect effects in a serial multiple mediator model.</a></li>
<li class="chapter" data-level="5.4.2" data-path="more-than-one-mediator.html"><a href="more-than-one-mediator.html#statistical-inference."><i class="fa fa-check"></i><b>5.4.2</b> Statistical inference.</a></li>
<li class="chapter" data-level="5.4.3" data-path="more-than-one-mediator.html"><a href="more-than-one-mediator.html#example-from-the-presumed-media-influence-study."><i class="fa fa-check"></i><b>5.4.3</b> Example from the presumed media influence study.</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="more-than-one-mediator.html"><a href="more-than-one-mediator.html#models-with-parallel-and-serial-mediation-properties"><i class="fa fa-check"></i><b>5.5</b> Models with parallel and serial mediation properties</a></li>
<li class="chapter" data-level="5.6" data-path="more-than-one-mediator.html"><a href="more-than-one-mediator.html#complementarity-and-competition-among-mediators"><i class="fa fa-check"></i><b>5.6</b> Complementarity and competition among mediators</a></li>
<li class="chapter" data-level="" data-path="more-than-one-mediator.html"><a href="more-than-one-mediator.html#references-2"><i class="fa fa-check"></i>References</a></li>
<li class="chapter" data-level="" data-path="more-than-one-mediator.html"><a href="more-than-one-mediator.html#session-info-4"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="mediation-analysis-with-a-multicategorical-antecedent.html"><a href="mediation-analysis-with-a-multicategorical-antecedent.html"><i class="fa fa-check"></i><b>6</b> Mediation Analysis with a Multicategorical Antecedent</a><ul>
<li class="chapter" data-level="6.1" data-path="mediation-analysis-with-a-multicategorical-antecedent.html"><a href="mediation-analysis-with-a-multicategorical-antecedent.html#relative-total-direct-and-indirect-effects"><i class="fa fa-check"></i><b>6.1</b> Relative total, direct, and indirect effects</a><ul>
<li class="chapter" data-level="6.1.1" data-path="mediation-analysis-with-a-multicategorical-antecedent.html"><a href="mediation-analysis-with-a-multicategorical-antecedent.html#relative-indirect-effects."><i class="fa fa-check"></i><b>6.1.1</b> Relative indirect effects.</a></li>
<li class="chapter" data-level="6.1.2" data-path="mediation-analysis-with-a-multicategorical-antecedent.html"><a href="mediation-analysis-with-a-multicategorical-antecedent.html#relative-direct-effects."><i class="fa fa-check"></i><b>6.1.2</b> Relative direct effects.</a></li>
<li class="chapter" data-level="6.1.3" data-path="mediation-analysis-with-a-multicategorical-antecedent.html"><a href="mediation-analysis-with-a-multicategorical-antecedent.html#relative-total-effects."><i class="fa fa-check"></i><b>6.1.3</b> Relative total effects.</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="mediation-analysis-with-a-multicategorical-antecedent.html"><a href="mediation-analysis-with-a-multicategorical-antecedent.html#an-example-sex-discrimination-in-the-workplace"><i class="fa fa-check"></i><b>6.2</b> An example: Sex discrimination in the workplace</a></li>
<li class="chapter" data-level="6.3" data-path="mediation-analysis-with-a-multicategorical-antecedent.html"><a href="mediation-analysis-with-a-multicategorical-antecedent.html#using-a-different-group-coding-system"><i class="fa fa-check"></i><b>6.3</b> Using a different group coding system</a></li>
<li class="chapter" data-level="6.4" data-path="mediation-analysis-with-a-multicategorical-antecedent.html"><a href="mediation-analysis-with-a-multicategorical-antecedent.html#some-miscellaneous-issues-unrelated-to-those-hayes-covered-in-the-text"><i class="fa fa-check"></i><b>6.4</b> Some miscellaneous issues [unrelated to those Hayes covered in the text]</a></li>
<li class="chapter" data-level="" data-path="mediation-analysis-with-a-multicategorical-antecedent.html"><a href="mediation-analysis-with-a-multicategorical-antecedent.html#references-3"><i class="fa fa-check"></i>References</a></li>
<li class="chapter" data-level="" data-path="mediation-analysis-with-a-multicategorical-antecedent.html"><a href="mediation-analysis-with-a-multicategorical-antecedent.html#session-info-5"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="part"><span><b>III MODERATION ANALYSIS</b></span></li>
<li class="chapter" data-level="7" data-path="fundamentals-of-moderation-analysis.html"><a href="fundamentals-of-moderation-analysis.html"><i class="fa fa-check"></i><b>7</b> Fundamentals of Moderation Analysis</a><ul>
<li class="chapter" data-level="7.1" data-path="fundamentals-of-moderation-analysis.html"><a href="fundamentals-of-moderation-analysis.html#conditional-and-unconditional-effects"><i class="fa fa-check"></i><b>7.1</b> Conditional and unconditional effects</a><ul>
<li class="chapter" data-level="7.1.1" data-path="fundamentals-of-moderation-analysis.html"><a href="fundamentals-of-moderation-analysis.html#eliminating-the-constraint-of-unconditionality."><i class="fa fa-check"></i><b>7.1.1</b> Eliminating the constraint of unconditionality.</a></li>
<li class="chapter" data-level="7.1.2" data-path="fundamentals-of-moderation-analysis.html"><a href="fundamentals-of-moderation-analysis.html#symmetry-in-moderation."><i class="fa fa-check"></i><b>7.1.2</b> Symmetry in moderation.</a></li>
<li class="chapter" data-level="7.1.3" data-path="fundamentals-of-moderation-analysis.html"><a href="fundamentals-of-moderation-analysis.html#interpretation-of-the-regression-coefficients."><i class="fa fa-check"></i><b>7.1.3</b> Interpretation of the regression coefficients.</a></li>
<li class="chapter" data-level="7.1.4" data-path="fundamentals-of-moderation-analysis.html"><a href="fundamentals-of-moderation-analysis.html#the-importance-of-b_3-wen-asking-about-mediation."><i class="fa fa-check"></i><b>7.1.4</b> The importance of <span class="math inline">\(b_3\)</span> wen asking about mediation.</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="fundamentals-of-moderation-analysis.html"><a href="fundamentals-of-moderation-analysis.html#an-example-climate-change-disasters-and-humanitarianism"><i class="fa fa-check"></i><b>7.2</b> An example: Climate change disasters and humanitarianism</a><ul>
<li class="chapter" data-level="7.2.1" data-path="fundamentals-of-moderation-analysis.html"><a href="fundamentals-of-moderation-analysis.html#estimation-using-process-brms."><i class="fa fa-check"></i><b>7.2.1</b> Estimation using <del>PROCESS</del> brms.</a></li>
<li class="chapter" data-level="7.2.2" data-path="fundamentals-of-moderation-analysis.html"><a href="fundamentals-of-moderation-analysis.html#interpreting-the-regression-coefficients."><i class="fa fa-check"></i><b>7.2.2</b> Interpreting the regression coefficients.</a></li>
<li class="chapter" data-level="7.2.3" data-path="fundamentals-of-moderation-analysis.html"><a href="fundamentals-of-moderation-analysis.html#variable-scaling-and-the-interpretation-of-b_1-and-b_3."><i class="fa fa-check"></i><b>7.2.3</b> Variable scaling and the interpretation of <span class="math inline">\(b_1\)</span> and <span class="math inline">\(b_3\)</span>.</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="fundamentals-of-moderation-analysis.html"><a href="fundamentals-of-moderation-analysis.html#visualizing-moderation"><i class="fa fa-check"></i><b>7.3</b> Visualizing moderation</a></li>
<li class="chapter" data-level="7.4" data-path="fundamentals-of-moderation-analysis.html"><a href="fundamentals-of-moderation-analysis.html#probing-an-interaction"><i class="fa fa-check"></i><b>7.4</b> Probing an interaction</a><ul>
<li class="chapter" data-level="7.4.1" data-path="fundamentals-of-moderation-analysis.html"><a href="fundamentals-of-moderation-analysis.html#the-pick-a-point-approach."><i class="fa fa-check"></i><b>7.4.1</b> The pick-a-point approach.</a></li>
<li class="chapter" data-level="7.4.2" data-path="fundamentals-of-moderation-analysis.html"><a href="fundamentals-of-moderation-analysis.html#the-johnson-neyman-technique."><i class="fa fa-check"></i><b>7.4.2</b> The Johnson-Neyman technique.</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="fundamentals-of-moderation-analysis.html"><a href="fundamentals-of-moderation-analysis.html#the-difference-between-testing-for-moderation-and-probing-it"><i class="fa fa-check"></i><b>7.5</b> The difference between testing for moderation and probing it</a></li>
<li class="chapter" data-level="7.6" data-path="fundamentals-of-moderation-analysis.html"><a href="fundamentals-of-moderation-analysis.html#artificial-categorization-and-subgroups"><i class="fa fa-check"></i><b>7.6</b> Artificial categorization and subgroups</a></li>
<li class="chapter" data-level="" data-path="fundamentals-of-moderation-analysis.html"><a href="fundamentals-of-moderation-analysis.html#references-4"><i class="fa fa-check"></i>References</a></li>
<li class="chapter" data-level="" data-path="fundamentals-of-moderation-analysis.html"><a href="fundamentals-of-moderation-analysis.html#session-info-6"><i class="fa fa-check"></i>Session info</a></li>
<li class="chapter" data-level="" data-path="fundamentals-of-moderation-analysis.html"><a href="fundamentals-of-moderation-analysis.html#footnote-1"><i class="fa fa-check"></i>Footnote</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="extending-the-fundamental-principles-of-moderation-analysis.html"><a href="extending-the-fundamental-principles-of-moderation-analysis.html"><i class="fa fa-check"></i><b>8</b> Extending the Fundamental Principles of Moderation Analysis</a><ul>
<li class="chapter" data-level="8.1" data-path="extending-the-fundamental-principles-of-moderation-analysis.html"><a href="extending-the-fundamental-principles-of-moderation-analysis.html#moderation-with-a-dichotomous-moderator"><i class="fa fa-check"></i><b>8.1</b> Moderation with a dichotomous moderator</a><ul>
<li class="chapter" data-level="8.1.1" data-path="extending-the-fundamental-principles-of-moderation-analysis.html"><a href="extending-the-fundamental-principles-of-moderation-analysis.html#visualizing-and-probing-the-interaction."><i class="fa fa-check"></i><b>8.1.1</b> Visualizing and probing the interaction.</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="extending-the-fundamental-principles-of-moderation-analysis.html"><a href="extending-the-fundamental-principles-of-moderation-analysis.html#interaction-between-two-quantitative-variables"><i class="fa fa-check"></i><b>8.2</b> Interaction between two quantitative variables</a><ul>
<li class="chapter" data-level="8.2.1" data-path="extending-the-fundamental-principles-of-moderation-analysis.html"><a href="extending-the-fundamental-principles-of-moderation-analysis.html#visualizing-and-probing-the-interaction.-1"><i class="fa fa-check"></i><b>8.2.1</b> Visualizing and probing the interaction.</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="extending-the-fundamental-principles-of-moderation-analysis.html"><a href="extending-the-fundamental-principles-of-moderation-analysis.html#hierarchical-versus-simultaneous-entry"><i class="fa fa-check"></i><b>8.3</b> Hierarchical versus simultaneous entry</a></li>
<li class="chapter" data-level="8.4" data-path="extending-the-fundamental-principles-of-moderation-analysis.html"><a href="extending-the-fundamental-principles-of-moderation-analysis.html#the-equivalence-between-moderated-regression-analysis-and-a-2-x-2-factorial-analysis-of-variance"><i class="fa fa-check"></i><b>8.4</b> The equivalence between moderated regression analysis and a 2 X 2 factorial analysis of variance</a><ul>
<li class="chapter" data-level="8.4.1" data-path="extending-the-fundamental-principles-of-moderation-analysis.html"><a href="extending-the-fundamental-principles-of-moderation-analysis.html#simple-effects-parameterization."><i class="fa fa-check"></i><b>8.4.1</b> Simple effects parameterization.</a></li>
<li class="chapter" data-level="8.4.2" data-path="extending-the-fundamental-principles-of-moderation-analysis.html"><a href="extending-the-fundamental-principles-of-moderation-analysis.html#main-effects-parameterization."><i class="fa fa-check"></i><b>8.4.2</b> Main effects parameterization.</a></li>
<li class="chapter" data-level="8.4.3" data-path="extending-the-fundamental-principles-of-moderation-analysis.html"><a href="extending-the-fundamental-principles-of-moderation-analysis.html#conducting-a-2-times-2-between-participants-factorial-anova-using-process-another-regression-model-with-brms."><i class="fa fa-check"></i><b>8.4.3</b> Conducting <del>a <span class="math inline">\(2 \times 2\)</span> between-participants factorial ANOVA using PROCESS</del> another regression model with brms.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="extending-the-fundamental-principles-of-moderation-analysis.html"><a href="extending-the-fundamental-principles-of-moderation-analysis.html#references-5"><i class="fa fa-check"></i>References</a></li>
<li class="chapter" data-level="" data-path="extending-the-fundamental-principles-of-moderation-analysis.html"><a href="extending-the-fundamental-principles-of-moderation-analysis.html#session-info-7"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="some-myths-and-additional-extensions-of-moderation-analysis.html"><a href="some-myths-and-additional-extensions-of-moderation-analysis.html"><i class="fa fa-check"></i><b>9</b> Some Myths and Additional Extensions of Moderation Analysis</a><ul>
<li class="chapter" data-level="9.1" data-path="some-myths-and-additional-extensions-of-moderation-analysis.html"><a href="some-myths-and-additional-extensions-of-moderation-analysis.html#truths-and-myths-about-mean-centering"><i class="fa fa-check"></i><b>9.1</b> Truths and myths about mean-centering</a><ul>
<li class="chapter" data-level="9.1.1" data-path="some-myths-and-additional-extensions-of-moderation-analysis.html"><a href="some-myths-and-additional-extensions-of-moderation-analysis.html#the-effect-of-mean-centering-on-multicollinearity-and-the-standard-error-of-b_3."><i class="fa fa-check"></i><b>9.1.1</b> The effect of mean-centering on multicollinearity and the standard error of <span class="math inline">\(b_3\)</span>.</a></li>
<li class="chapter" data-level="9.1.2" data-path="some-myths-and-additional-extensions-of-moderation-analysis.html"><a href="some-myths-and-additional-extensions-of-moderation-analysis.html#the-effect-of-mean-centering-on-b_1-b_2-and-their-standard-errors-posterior-sds."><i class="fa fa-check"></i><b>9.1.2</b> The effect of mean-centering on <span class="math inline">\(b_1\)</span>, <span class="math inline">\(b_2\)</span>, and their <del>standard errors</del> posterior <span class="math inline">\(SD\)</span>s.</a></li>
<li class="chapter" data-level="9.1.3" data-path="some-myths-and-additional-extensions-of-moderation-analysis.html"><a href="some-myths-and-additional-extensions-of-moderation-analysis.html#the-centering-option-in-process."><i class="fa fa-check"></i><b>9.1.3</b> The <del>centering option in PROCESS</del>.</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="some-myths-and-additional-extensions-of-moderation-analysis.html"><a href="some-myths-and-additional-extensions-of-moderation-analysis.html#the-estimation-and-interpretation-of-standardized-regression-coefficients-in-a-moderation-analysis"><i class="fa fa-check"></i><b>9.2</b> The estimation and interpretation of standardized regression coefficients in a moderation analysis</a><ul>
<li class="chapter" data-level="9.2.1" data-path="some-myths-and-additional-extensions-of-moderation-analysis.html"><a href="some-myths-and-additional-extensions-of-moderation-analysis.html#variant-1."><i class="fa fa-check"></i><b>9.2.1</b> Variant 1.</a></li>
<li class="chapter" data-level="9.2.2" data-path="some-myths-and-additional-extensions-of-moderation-analysis.html"><a href="some-myths-and-additional-extensions-of-moderation-analysis.html#variant-2."><i class="fa fa-check"></i><b>9.2.2</b> Variant 2.</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="some-myths-and-additional-extensions-of-moderation-analysis.html"><a href="some-myths-and-additional-extensions-of-moderation-analysis.html#a-caution-on-manual-centering-and-standardization-because-of-missing-data"><i class="fa fa-check"></i><b>9.3</b> A caution on manual centering and standardization [because of missing data]</a></li>
<li class="chapter" data-level="9.4" data-path="some-myths-and-additional-extensions-of-moderation-analysis.html"><a href="some-myths-and-additional-extensions-of-moderation-analysis.html#more-than-one-moderator"><i class="fa fa-check"></i><b>9.4</b> More than one moderator</a><ul>
<li class="chapter" data-level="9.4.1" data-path="some-myths-and-additional-extensions-of-moderation-analysis.html"><a href="some-myths-and-additional-extensions-of-moderation-analysis.html#additive-multiple-moderation."><i class="fa fa-check"></i><b>9.4.1</b> Additive multiple moderation.</a></li>
<li class="chapter" data-level="9.4.2" data-path="some-myths-and-additional-extensions-of-moderation-analysis.html"><a href="some-myths-and-additional-extensions-of-moderation-analysis.html#moderated-moderation."><i class="fa fa-check"></i><b>9.4.2</b> Moderated moderation.</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="some-myths-and-additional-extensions-of-moderation-analysis.html"><a href="some-myths-and-additional-extensions-of-moderation-analysis.html#comparing-conditional-effects"><i class="fa fa-check"></i><b>9.5</b> Comparing conditional effects</a><ul>
<li class="chapter" data-level="9.5.1" data-path="some-myths-and-additional-extensions-of-moderation-analysis.html"><a href="some-myths-and-additional-extensions-of-moderation-analysis.html#comparing-conditional-effects-in-the-additive-multiple-moderation-model."><i class="fa fa-check"></i><b>9.5.1</b> Comparing conditional effects in the additive multiple moderation model.</a></li>
<li class="chapter" data-level="9.5.2" data-path="some-myths-and-additional-extensions-of-moderation-analysis.html"><a href="some-myths-and-additional-extensions-of-moderation-analysis.html#comparing-conditional-effects-in-the-moderated-moderation-model."><i class="fa fa-check"></i><b>9.5.2</b> Comparing conditional effects in the moderated moderation model.</a></li>
<li class="chapter" data-level="9.5.3" data-path="some-myths-and-additional-extensions-of-moderation-analysis.html"><a href="some-myths-and-additional-extensions-of-moderation-analysis.html#implementation-in-process-brms.-1"><i class="fa fa-check"></i><b>9.5.3</b> Implementation in <del>PROCESS</del> brms.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="some-myths-and-additional-extensions-of-moderation-analysis.html"><a href="some-myths-and-additional-extensions-of-moderation-analysis.html#references-6"><i class="fa fa-check"></i>References</a></li>
<li class="chapter" data-level="" data-path="some-myths-and-additional-extensions-of-moderation-analysis.html"><a href="some-myths-and-additional-extensions-of-moderation-analysis.html#session-info-8"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="multicategorical-focal-antecedents-and-moderators.html"><a href="multicategorical-focal-antecedents-and-moderators.html"><i class="fa fa-check"></i><b>10</b> Multicategorical Focal Antecedents and Moderators</a><ul>
<li class="chapter" data-level="10.1" data-path="multicategorical-focal-antecedents-and-moderators.html"><a href="multicategorical-focal-antecedents-and-moderators.html#moderation-of-the-effect-of-a-multicategorical-antecedent-variable"><i class="fa fa-check"></i><b>10.1</b> Moderation of the effect of a multicategorical antecedent variable</a></li>
<li class="chapter" data-level="10.2" data-path="multicategorical-focal-antecedents-and-moderators.html"><a href="multicategorical-focal-antecedents-and-moderators.html#an-example-from-the-sex-disrimination-in-the-workplace-study"><i class="fa fa-check"></i><b>10.2</b> An example from the sex disrimination in the workplace study</a></li>
<li class="chapter" data-level="10.3" data-path="multicategorical-focal-antecedents-and-moderators.html"><a href="multicategorical-focal-antecedents-and-moderators.html#visualizing-the-model"><i class="fa fa-check"></i><b>10.3</b> Visualizing the model</a></li>
<li class="chapter" data-level="10.4" data-path="multicategorical-focal-antecedents-and-moderators.html"><a href="multicategorical-focal-antecedents-and-moderators.html#probing-the-interaction"><i class="fa fa-check"></i><b>10.4</b> Probing the interaction</a><ul>
<li class="chapter" data-level="10.4.1" data-path="multicategorical-focal-antecedents-and-moderators.html"><a href="multicategorical-focal-antecedents-and-moderators.html#the-pick-a-point-approach.-1"><i class="fa fa-check"></i><b>10.4.1</b> The pick-a-point approach.</a></li>
<li class="chapter" data-level="10.4.2" data-path="multicategorical-focal-antecedents-and-moderators.html"><a href="multicategorical-focal-antecedents-and-moderators.html#the-johnson-neyman-technique.-1"><i class="fa fa-check"></i><b>10.4.2</b> The Johnson-Neyman technique.</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="multicategorical-focal-antecedents-and-moderators.html"><a href="multicategorical-focal-antecedents-and-moderators.html#when-the-moderator-is-multicategorical"><i class="fa fa-check"></i><b>10.5</b> When the moderator is multicategorical</a><ul>
<li class="chapter" data-level="10.5.1" data-path="multicategorical-focal-antecedents-and-moderators.html"><a href="multicategorical-focal-antecedents-and-moderators.html#an-example."><i class="fa fa-check"></i><b>10.5.1</b> An example.</a></li>
<li class="chapter" data-level="10.5.2" data-path="multicategorical-focal-antecedents-and-moderators.html"><a href="multicategorical-focal-antecedents-and-moderators.html#probing-the-interaction-and-interpreting-the-regression-coefficients."><i class="fa fa-check"></i><b>10.5.2</b> Probing the interaction and interpreting the regression coefficients.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="multicategorical-focal-antecedents-and-moderators.html"><a href="multicategorical-focal-antecedents-and-moderators.html#references-7"><i class="fa fa-check"></i>References</a></li>
<li class="chapter" data-level="" data-path="multicategorical-focal-antecedents-and-moderators.html"><a href="multicategorical-focal-antecedents-and-moderators.html#session-info-9"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="part"><span><b>IV CONDITIONAL PROCESS ANALYSIS</b></span></li>
<li class="chapter" data-level="11" data-path="fundamentals-of-conditional-process-analysis.html"><a href="fundamentals-of-conditional-process-analysis.html"><i class="fa fa-check"></i><b>11</b> Fundamentals of Conditional Process Analysis</a><ul>
<li class="chapter" data-level="11.1" data-path="fundamentals-of-conditional-process-analysis.html"><a href="fundamentals-of-conditional-process-analysis.html#examples-of-conditional-process-models-in-the-literature"><i class="fa fa-check"></i><b>11.1</b> Examples of conditional process models in the literature</a></li>
<li class="chapter" data-level="11.2" data-path="fundamentals-of-conditional-process-analysis.html"><a href="fundamentals-of-conditional-process-analysis.html#conditional-direct-and-indirect-effects"><i class="fa fa-check"></i><b>11.2</b> Conditional direct and indirect effects</a></li>
<li class="chapter" data-level="11.3" data-path="fundamentals-of-conditional-process-analysis.html"><a href="fundamentals-of-conditional-process-analysis.html#example-hiding-your-feelings-from-your-work-team"><i class="fa fa-check"></i><b>11.3</b> Example: Hiding your feelings from your work team</a></li>
<li class="chapter" data-level="11.4" data-path="fundamentals-of-conditional-process-analysis.html"><a href="fundamentals-of-conditional-process-analysis.html#estimation-of-a-conditional-process-model-using-process"><i class="fa fa-check"></i><b>11.4</b> <del>Estimation of a conditional process model using PROCESS</del></a></li>
<li class="chapter" data-level="11.5" data-path="fundamentals-of-conditional-process-analysis.html"><a href="fundamentals-of-conditional-process-analysis.html#quantifying-and-visualizing-conditional-indirect-and-direct-effects."><i class="fa fa-check"></i><b>11.5</b> Quantifying and visualizing (conditional) indirect and direct effects.</a><ul>
<li class="chapter" data-level="11.5.1" data-path="fundamentals-of-conditional-process-analysis.html"><a href="fundamentals-of-conditional-process-analysis.html#visualizing-the-direct-and-indirect-effects."><i class="fa fa-check"></i><b>11.5.1</b> Visualizing the direct and indirect effects.</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="fundamentals-of-conditional-process-analysis.html"><a href="fundamentals-of-conditional-process-analysis.html#statistical-inference-3"><i class="fa fa-check"></i><b>11.6</b> Statistical inference</a><ul>
<li class="chapter" data-level="11.6.1" data-path="fundamentals-of-conditional-process-analysis.html"><a href="fundamentals-of-conditional-process-analysis.html#inference-about-the-direct-effect."><i class="fa fa-check"></i><b>11.6.1</b> Inference about the direct effect.</a></li>
<li class="chapter" data-level="11.6.2" data-path="fundamentals-of-conditional-process-analysis.html"><a href="fundamentals-of-conditional-process-analysis.html#inference-about-the-indirect-effect."><i class="fa fa-check"></i><b>11.6.2</b> Inference about the indirect effect.</a></li>
<li class="chapter" data-level="11.6.3" data-path="fundamentals-of-conditional-process-analysis.html"><a href="fundamentals-of-conditional-process-analysis.html#probing-moderation-of-mediation."><i class="fa fa-check"></i><b>11.6.3</b> Probing moderation of mediation.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="fundamentals-of-conditional-process-analysis.html"><a href="fundamentals-of-conditional-process-analysis.html#references-8"><i class="fa fa-check"></i>References</a></li>
<li class="chapter" data-level="" data-path="fundamentals-of-conditional-process-analysis.html"><a href="fundamentals-of-conditional-process-analysis.html#session-info-10"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="further-examples-of-conditional-process-analysis.html"><a href="further-examples-of-conditional-process-analysis.html"><i class="fa fa-check"></i><b>12</b> Further Examples of Conditional Process Analysis</a><ul>
<li class="chapter" data-level="12.1" data-path="further-examples-of-conditional-process-analysis.html"><a href="further-examples-of-conditional-process-analysis.html#revisiting-the-disaster-framing-study"><i class="fa fa-check"></i><b>12.1</b> Revisiting the disaster framing study</a></li>
<li class="chapter" data-level="12.2" data-path="further-examples-of-conditional-process-analysis.html"><a href="further-examples-of-conditional-process-analysis.html#moderation-of-the-direct-and-indirect-effects-in-a-conditional-process-model"><i class="fa fa-check"></i><b>12.2</b> Moderation of the direct and indirect effects in a conditional process model</a><ul>
<li class="chapter" data-level="12.2.1" data-path="further-examples-of-conditional-process-analysis.html"><a href="further-examples-of-conditional-process-analysis.html#estimation-using-process."><i class="fa fa-check"></i><b>12.2.1</b> <del>Estimation using PROCESS</del>.</a></li>
<li class="chapter" data-level="12.2.2" data-path="further-examples-of-conditional-process-analysis.html"><a href="further-examples-of-conditional-process-analysis.html#quantifying-direct-and-indirect-effects."><i class="fa fa-check"></i><b>12.2.2</b> Quantifying direct and indirect effects.</a></li>
<li class="chapter" data-level="12.2.3" data-path="further-examples-of-conditional-process-analysis.html"><a href="further-examples-of-conditional-process-analysis.html#visualizing-the-direct-and-indirect-effects.-1"><i class="fa fa-check"></i><b>12.2.3</b> Visualizing the direct and indirect effects.</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="further-examples-of-conditional-process-analysis.html"><a href="further-examples-of-conditional-process-analysis.html#statistical-inference-4"><i class="fa fa-check"></i><b>12.3</b> Statistical inference</a><ul>
<li class="chapter" data-level="12.3.1" data-path="further-examples-of-conditional-process-analysis.html"><a href="further-examples-of-conditional-process-analysis.html#inference-about-the-direct-effect.-1"><i class="fa fa-check"></i><b>12.3.1</b> Inference about the direct effect.</a></li>
<li class="chapter" data-level="12.3.2" data-path="further-examples-of-conditional-process-analysis.html"><a href="further-examples-of-conditional-process-analysis.html#inference-about-the-indirect-effect.-1"><i class="fa fa-check"></i><b>12.3.2</b> Inference about the indirect effect.</a></li>
<li class="chapter" data-level="12.3.3" data-path="further-examples-of-conditional-process-analysis.html"><a href="further-examples-of-conditional-process-analysis.html#pruning-the-model."><i class="fa fa-check"></i><b>12.3.3</b> Pruning the model.</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="further-examples-of-conditional-process-analysis.html"><a href="further-examples-of-conditional-process-analysis.html#mediated-moderation"><i class="fa fa-check"></i><b>12.4</b> Mediated moderation</a><ul>
<li class="chapter" data-level="12.4.1" data-path="further-examples-of-conditional-process-analysis.html"><a href="further-examples-of-conditional-process-analysis.html#mediated-moderation-as-the-indirect-effect-of-a-product."><i class="fa fa-check"></i><b>12.4.1</b> Mediated moderation as the indirect effect of a product.</a></li>
<li class="chapter" data-level="12.4.2" data-path="further-examples-of-conditional-process-analysis.html"><a href="further-examples-of-conditional-process-analysis.html#why-mediated-moderation-is-neither-interesting-nor-meaningful."><i class="fa fa-check"></i><b>12.4.2</b> Why mediated moderation is neither interesting nor meaningful.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="further-examples-of-conditional-process-analysis.html"><a href="further-examples-of-conditional-process-analysis.html#references-9"><i class="fa fa-check"></i>References</a></li>
<li class="chapter" data-level="" data-path="further-examples-of-conditional-process-analysis.html"><a href="further-examples-of-conditional-process-analysis.html#session-info-11"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="conditional-process-analysis-with-a-multicategorical-antecedent.html"><a href="conditional-process-analysis-with-a-multicategorical-antecedent.html"><i class="fa fa-check"></i><b>13</b> Conditional Process Analysis with a Multicategorical Antecedent</a><ul>
<li class="chapter" data-level="13.1" data-path="conditional-process-analysis-with-a-multicategorical-antecedent.html"><a href="conditional-process-analysis-with-a-multicategorical-antecedent.html#revisiting-sexual-discrimination-in-the-workplace"><i class="fa fa-check"></i><b>13.1</b> Revisiting sexual discrimination in the workplace</a></li>
<li class="chapter" data-level="13.2" data-path="conditional-process-analysis-with-a-multicategorical-antecedent.html"><a href="conditional-process-analysis-with-a-multicategorical-antecedent.html#looking-at-the-components-of-the-indirect-effect-of-x"><i class="fa fa-check"></i><b>13.2</b> Looking at the components of the indirect effect of <span class="math inline">\(X\)</span></a><ul>
<li class="chapter" data-level="13.2.1" data-path="conditional-process-analysis-with-a-multicategorical-antecedent.html"><a href="conditional-process-analysis-with-a-multicategorical-antecedent.html#examining-the-first-stage-of-the-mediation-process."><i class="fa fa-check"></i><b>13.2.1</b> Examining the first stage of the mediation process.</a></li>
<li class="chapter" data-level="13.2.2" data-path="conditional-process-analysis-with-a-multicategorical-antecedent.html"><a href="conditional-process-analysis-with-a-multicategorical-antecedent.html#estimating-the-second-stage-of-the-mediation-process."><i class="fa fa-check"></i><b>13.2.2</b> Estimating the second stage of the mediation process.</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="conditional-process-analysis-with-a-multicategorical-antecedent.html"><a href="conditional-process-analysis-with-a-multicategorical-antecedent.html#relative-conditional-indirect-effects"><i class="fa fa-check"></i><b>13.3</b> Relative conditional indirect effects</a></li>
<li class="chapter" data-level="13.4" data-path="conditional-process-analysis-with-a-multicategorical-antecedent.html"><a href="conditional-process-analysis-with-a-multicategorical-antecedent.html#testing-and-probing-moderation-of-mediation"><i class="fa fa-check"></i><b>13.4</b> Testing and probing moderation of mediation</a><ul>
<li class="chapter" data-level="13.4.1" data-path="conditional-process-analysis-with-a-multicategorical-antecedent.html"><a href="conditional-process-analysis-with-a-multicategorical-antecedent.html#a-test-of-moderation-of-the-relative-indirect-effect."><i class="fa fa-check"></i><b>13.4.1</b> A test of moderation of the relative indirect effect.</a></li>
<li class="chapter" data-level="13.4.2" data-path="conditional-process-analysis-with-a-multicategorical-antecedent.html"><a href="conditional-process-analysis-with-a-multicategorical-antecedent.html#probing-moderation-of-mediation.-2"><i class="fa fa-check"></i><b>13.4.2</b> Probing moderation of mediation.</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="conditional-process-analysis-with-a-multicategorical-antecedent.html"><a href="conditional-process-analysis-with-a-multicategorical-antecedent.html#relative-conditional-direct-effects"><i class="fa fa-check"></i><b>13.5</b> Relative conditional direct effects</a></li>
<li class="chapter" data-level="" data-path="conditional-process-analysis-with-a-multicategorical-antecedent.html"><a href="conditional-process-analysis-with-a-multicategorical-antecedent.html#references-10"><i class="fa fa-check"></i>References</a></li>
<li class="chapter" data-level="" data-path="conditional-process-analysis-with-a-multicategorical-antecedent.html"><a href="conditional-process-analysis-with-a-multicategorical-antecedent.html#session-info-12"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="part"><span><b>V MISCELLANEA</b></span></li>
<li class="chapter" data-level="14" data-path="miscellaneous-topics-and-some-frequently-asked-questions.html"><a href="miscellaneous-topics-and-some-frequently-asked-questions.html"><i class="fa fa-check"></i><b>14</b> Miscellaneous Topics and Some Frequently Asked Questions</a><ul>
<li class="chapter" data-level="14.1" data-path="miscellaneous-topics-and-some-frequently-asked-questions.html"><a href="miscellaneous-topics-and-some-frequently-asked-questions.html#a-strategy-for-approaching-a-conditional-process-analysis"><i class="fa fa-check"></i><b>14.1</b> A strategy for approaching a conditional process analysis</a><ul>
<li class="chapter" data-level="14.1.1" data-path="miscellaneous-topics-and-some-frequently-asked-questions.html"><a href="miscellaneous-topics-and-some-frequently-asked-questions.html#step-1-construct-your-conceptual-diagram-of-the-process."><i class="fa fa-check"></i><b>14.1.1</b> Step 1: Construct your conceptual diagram of the process.</a></li>
<li class="chapter" data-level="14.1.2" data-path="miscellaneous-topics-and-some-frequently-asked-questions.html"><a href="miscellaneous-topics-and-some-frequently-asked-questions.html#step-2-translate-the-conceptual-model-into-a-statistical-model."><i class="fa fa-check"></i><b>14.1.2</b> Step 2: Translate the conceptual model into a statistical model.</a></li>
<li class="chapter" data-level="14.1.3" data-path="miscellaneous-topics-and-some-frequently-asked-questions.html"><a href="miscellaneous-topics-and-some-frequently-asked-questions.html#step-3-estimate-the-statistical-model."><i class="fa fa-check"></i><b>14.1.3</b> Step 3: Estimate the statistical model.</a></li>
<li class="chapter" data-level="14.1.4" data-path="miscellaneous-topics-and-some-frequently-asked-questions.html"><a href="miscellaneous-topics-and-some-frequently-asked-questions.html#step-4-determine-whether-expected-moderation-exists."><i class="fa fa-check"></i><b>14.1.4</b> Step 4: Determine whether expected moderation exists.</a></li>
<li class="chapter" data-level="14.1.5" data-path="miscellaneous-topics-and-some-frequently-asked-questions.html"><a href="miscellaneous-topics-and-some-frequently-asked-questions.html#step-5-probe-and-interpret-interactions-involving-components-of-the-indirect-effect."><i class="fa fa-check"></i><b>14.1.5</b> Step 5: Probe and interpret interactions involving components of the indirect effect.</a></li>
<li class="chapter" data-level="14.1.6" data-path="miscellaneous-topics-and-some-frequently-asked-questions.html"><a href="miscellaneous-topics-and-some-frequently-asked-questions.html#step-6-quantify-and-test-conditional-indirect-effects-if-relevant."><i class="fa fa-check"></i><b>14.1.6</b> Step 6: Quantify and test conditional indirect effects (if relevant).</a></li>
<li class="chapter" data-level="14.1.7" data-path="miscellaneous-topics-and-some-frequently-asked-questions.html"><a href="miscellaneous-topics-and-some-frequently-asked-questions.html#step-7-quantify-and-test-conditional-direct-effects-if-relevant."><i class="fa fa-check"></i><b>14.1.7</b> Step 7: Quantify and test conditional direct effects (if relevant).</a></li>
<li class="chapter" data-level="14.1.8" data-path="miscellaneous-topics-and-some-frequently-asked-questions.html"><a href="miscellaneous-topics-and-some-frequently-asked-questions.html#step-8-tell-your-story."><i class="fa fa-check"></i><b>14.1.8</b> Step 8: Tell your story.</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="miscellaneous-topics-and-some-frequently-asked-questions.html"><a href="miscellaneous-topics-and-some-frequently-asked-questions.html#how-do-i-write-about-this"><i class="fa fa-check"></i><b>14.2</b> How do I write about this?</a><ul>
<li class="chapter" data-level="14.2.1" data-path="miscellaneous-topics-and-some-frequently-asked-questions.html"><a href="miscellaneous-topics-and-some-frequently-asked-questions.html#reporting-a-mediation-analysis."><i class="fa fa-check"></i><b>14.2.1</b> Reporting a mediation analysis.</a></li>
<li class="chapter" data-level="14.2.2" data-path="miscellaneous-topics-and-some-frequently-asked-questions.html"><a href="miscellaneous-topics-and-some-frequently-asked-questions.html#reporting-a-moderation-analysis."><i class="fa fa-check"></i><b>14.2.2</b> Reporting a moderation analysis.</a></li>
<li class="chapter" data-level="14.2.3" data-path="miscellaneous-topics-and-some-frequently-asked-questions.html"><a href="miscellaneous-topics-and-some-frequently-asked-questions.html#reporting-a-conditional-process-analysis."><i class="fa fa-check"></i><b>14.2.3</b> Reporting a conditional process analysis.</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="miscellaneous-topics-and-some-frequently-asked-questions.html"><a href="miscellaneous-topics-and-some-frequently-asked-questions.html#should-i-use-structural-equation-modeling-instead-of-regression-analysis"><i class="fa fa-check"></i><b>14.3</b> Should I use structural equation modeling instead of regression analysis?</a></li>
<li class="chapter" data-level="14.4" data-path="miscellaneous-topics-and-some-frequently-asked-questions.html"><a href="miscellaneous-topics-and-some-frequently-asked-questions.html#the-pitfalls-of-subgroups-analysis"><i class="fa fa-check"></i><b>14.4</b> The pitfalls of subgroups analysis</a></li>
<li class="chapter" data-level="14.5" data-path="miscellaneous-topics-and-some-frequently-asked-questions.html"><a href="miscellaneous-topics-and-some-frequently-asked-questions.html#can-a-variable-simultaneously-mediate-and-moderate-another-variables-effect"><i class="fa fa-check"></i><b>14.5</b> Can a variable simultaneously mediate and moderate another variable’s effect?</a></li>
<li class="chapter" data-level="14.6" data-path="miscellaneous-topics-and-some-frequently-asked-questions.html"><a href="miscellaneous-topics-and-some-frequently-asked-questions.html#interaction-between-x-and-m-in-mediation-analysis"><i class="fa fa-check"></i><b>14.6</b> Interaction between <span class="math inline">\(X\)</span> and <span class="math inline">\(M\)</span> in mediation analysis?</a></li>
<li class="chapter" data-level="14.7" data-path="miscellaneous-topics-and-some-frequently-asked-questions.html"><a href="miscellaneous-topics-and-some-frequently-asked-questions.html#repeated-measures-designs"><i class="fa fa-check"></i><b>14.7</b> Repeated measures designs</a></li>
<li class="chapter" data-level="14.8" data-path="miscellaneous-topics-and-some-frequently-asked-questions.html"><a href="miscellaneous-topics-and-some-frequently-asked-questions.html#dichotomous-ordinal-count-and-survival-outcomes"><i class="fa fa-check"></i><b>14.8</b> Dichotomous, ordinal, count, and survival outcomes</a></li>
<li class="chapter" data-level="" data-path="miscellaneous-topics-and-some-frequently-asked-questions.html"><a href="miscellaneous-topics-and-some-frequently-asked-questions.html#reference-2"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="miscellaneous-topics-and-some-frequently-asked-questions.html"><a href="miscellaneous-topics-and-some-frequently-asked-questions.html#session-info-13"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Recoding <em>Introduction to Mediation, Moderation, and Conditional Process Analysis</em></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="fundamentals-of-linear-regression" class="section level1">
<h1><span class="header-section-number">2</span> Fundamentals of Linear Regression</h1>
<blockquote>
<p>Linear regression is the foundation of most of the methods [Hayes described in his] book, so a solid understanding of the fundamentals of linear regression is essential. I assume that most readers have been exposed to linear regression in some form before discovering this book, and so some of the material will be review. Even so, I encourage everyone to read this chapter. (p. 30)</p>
</blockquote>
<p>Since we’re adding Bayes and the <strong>tidyverse</strong> into the mix, walking through this chapter will be double important, for us.</p>
<div id="correlation-and-prediction" class="section level2">
<h2><span class="header-section-number">2.1</span> Correlation and prediction</h2>
<p>Here we load a couple necessary packages, load the data, and take a peek.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw">library</span>(tidyverse)</a>
<a class="sourceLine" id="cb5-2" data-line-number="2"></a>
<a class="sourceLine" id="cb5-3" data-line-number="3">glbwarm &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data/glbwarm/glbwarm.csv&quot;</span>)</a>
<a class="sourceLine" id="cb5-4" data-line-number="4"></a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="kw">glimpse</span>(glbwarm)</a></code></pre></div>
<pre><code>## Observations: 815
## Variables: 7
## $ govact   &lt;dbl&gt; 3.6, 5.0, 6.6, 1.0, 4.0, 7.0, 6.8, 5.6, 6.0, 2.6, 1.4, 5.6, 7.0, 3.8, 3.4, 4.2, 1.0, 2.6, …
## $ posemot  &lt;dbl&gt; 3.67, 2.00, 2.33, 5.00, 2.33, 1.00, 2.33, 4.00, 5.00, 5.00, 1.00, 4.00, 1.00, 5.67, 3.00, …
## $ negemot  &lt;dbl&gt; 4.67, 2.33, 3.67, 5.00, 1.67, 6.00, 4.00, 5.33, 6.00, 2.00, 1.00, 4.00, 5.00, 4.67, 2.00, …
## $ ideology &lt;dbl&gt; 6, 2, 1, 1, 4, 3, 4, 5, 4, 7, 6, 4, 2, 4, 5, 2, 6, 4, 2, 4, 4, 2, 6, 4, 4, 3, 4, 5, 4, 5, …
## $ age      &lt;dbl&gt; 61, 55, 85, 59, 22, 34, 47, 65, 50, 60, 71, 60, 71, 59, 32, 36, 69, 70, 41, 48, 38, 63, 71…
## $ sex      &lt;dbl&gt; 0, 0, 1, 0, 1, 0, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 1, …
## $ partyid  &lt;dbl&gt; 2, 1, 1, 1, 1, 2, 1, 1, 2, 3, 2, 1, 1, 1, 1, 1, 2, 3, 1, 3, 2, 1, 3, 2, 1, 1, 1, 3, 1, 1, …</code></pre>
<p>If you are new to <strong>tidyverse</strong>-style syntax, possibly the oddest component is the pipe (i.e., <code>%&gt;%</code>). I’m not going to explain the <code>%&gt;%</code> in this project, but you might learn more about in <a href="https://www.youtube.com/watch?v=9yjhxvu-pDg">this brief clip</a>, starting around <a href="https://www.youtube.com/watch?v=K-ss_ag2k9E&amp;t=1285s">minute 21:25 in this talk by Wickham</a>, or in <a href="http://r4ds.had.co.nz/transform.html#combining-multiple-operations-with-the-pipe">section 5.6.1 from Grolemund and Wickham’s <em>R for Data Science</em></a>. Really, all of chapter 5 of <em>R4DS</em> is great for new <strong>R</strong> and new <strong>tidyverse</strong> users, and their chapter 3 is a nice introduction to plotting with <strong>ggplot2</strong>.</p>
<p>Here is our version of Figure 2.1.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">glbwarm <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="st">  </span><span class="kw">group_by</span>(negemot, govact) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="st">  </span><span class="kw">count</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="st">  </span></a>
<a class="sourceLine" id="cb7-5" data-line-number="5"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> negemot, <span class="dt">y =</span> govact, <span class="dt">size =</span> n)) <span class="op">+</span></a>
<a class="sourceLine" id="cb7-6" data-line-number="6"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">show.legend =</span> F) <span class="op">+</span></a>
<a class="sourceLine" id="cb7-7" data-line-number="7"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;NEGEMOT: Negative emotions about climate change (&quot;</span>, <span class="kw">italic</span>(<span class="st">&quot;X&quot;</span>), <span class="st">&quot;)&quot;</span>)),</a>
<a class="sourceLine" id="cb7-8" data-line-number="8">       <span class="dt">y =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;GOVACT: Support for governmentaction (&quot;</span>, <span class="kw">italic</span>(<span class="st">&quot;Y&quot;</span>), <span class="st">&quot;)&quot;</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb7-9" data-line-number="9"><span class="st">  </span><span class="kw">theme_bw</span>()</a></code></pre></div>
<p><img src="02_files/figure-html/unnamed-chunk-3-1.png" width="480" /></p>
<p>There are other ways to handle the <a href="http://ggplot2.tidyverse.org/reference/position_jitter.html">overplotting issue, such as jittering</a>.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">glbwarm <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> negemot, <span class="dt">y =</span> govact)) <span class="op">+</span></a>
<a class="sourceLine" id="cb8-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">height =</span> <span class="fl">.05</span>, <span class="dt">width =</span> <span class="fl">.05</span>, </a>
<a class="sourceLine" id="cb8-4" data-line-number="4">              <span class="dt">alpha =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>, <span class="dt">size =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb8-5" data-line-number="5"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;NEGEMOT: Negative emotions about climate change (&quot;</span>, <span class="kw">italic</span>(<span class="st">&quot;X&quot;</span>), <span class="st">&quot;)&quot;</span>)),</a>
<a class="sourceLine" id="cb8-6" data-line-number="6">       <span class="dt">y =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;GOVACT: Support for governmentaction (&quot;</span>, <span class="kw">italic</span>(<span class="st">&quot;Y&quot;</span>), <span class="st">&quot;)&quot;</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb8-7" data-line-number="7"><span class="st">  </span><span class="kw">theme_bw</span>()</a></code></pre></div>
<p><img src="02_files/figure-html/unnamed-chunk-4-1.png" width="480" /></p>
<p>The <code>cor()</code> function is a simple way to compute a Pearson’s correlation coefficient.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="kw">cor</span>(glbwarm<span class="op">$</span>negemot, glbwarm<span class="op">$</span>govact)</a></code></pre></div>
<pre><code>## [1] 0.5777458</code></pre>
<p>If you want more plentiful output, the <code>cor.test()</code> function returns a <span class="math inline">\(t\)</span>-value, the degrees of freedom, the corresponding <span class="math inline">\(p\)</span>-value and the 95% confidence intervals, in addition to the Pearson’s correlation coefficient.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="kw">cor.test</span>(glbwarm<span class="op">$</span>negemot, glbwarm<span class="op">$</span>govact)</a></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  glbwarm$negemot and glbwarm$govact
## t = 20.183, df = 813, p-value &lt; 2.2e-16
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  0.5301050 0.6217505
## sample estimates:
##       cor 
## 0.5777458</code></pre>
<p>To get the Bayesian version, we’ll open our focal statistical package, Bürkner’s <a href="https://github.com/paul-buerkner/brms"><strong>brms</strong></a>. [And I’ll briefly note that you could also do many of these analyses with other packages, such as <a href="https://cran.r-project.org/web/packages/blavaan/index.html"><strong>blavaan</strong></a> or <a href="https://github.com/stan-dev/rstanarm"><strong>rstanarm</strong></a>. I just prefer <strong>brms</strong>.]</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="kw">library</span>(brms)</a></code></pre></div>
<p>We’ll start simple and just use the default priors and settings, but with the addition of parallel sampling via <code>cores = 4</code>.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1">model2<span class="fl">.1</span> &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb14-2" data-line-number="2"><span class="st">  </span><span class="kw">brm</span>(<span class="dt">data =</span> glbwarm, </a>
<a class="sourceLine" id="cb14-3" data-line-number="3">      <span class="dt">family =</span> gaussian,</a>
<a class="sourceLine" id="cb14-4" data-line-number="4">      <span class="kw">mvbind</span>(negemot, govact) <span class="op">~</span><span class="st"> </span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb14-5" data-line-number="5">      <span class="dt">cores =</span> <span class="dv">4</span>)</a></code></pre></div>
<p>We can examine a summary of the output with the <code>print()</code> function.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="kw">print</span>(model2<span class="fl">.1</span>)</a></code></pre></div>
<pre><code>##  Family: MV(gaussian, gaussian) 
##   Links: mu = identity; sigma = identity
##          mu = identity; sigma = identity 
## Formula: negemot ~ 1 
##          govact ~ 1 
##    Data: glbwarm (Number of observations: 815) 
## Samples: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
##          total post-warmup samples = 4000
## 
## Population-Level Effects: 
##                   Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## negemot_Intercept     3.56      0.05     3.46     3.66 1.00     3586     3085
## govact_Intercept      4.59      0.05     4.50     4.68 1.00     3742     3188
## 
## Family Specific Parameters: 
##               Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sigma_negemot     1.53      0.04     1.46     1.61 1.00     3276     2964
## sigma_govact      1.36      0.03     1.30     1.43 1.00     3209     2825
## 
## Residual Correlations: 
##                        Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## rescor(negemot,govact)     0.58      0.02     0.53     0.62 1.00     3496     2476
## 
## Samples were drawn using sampling(NUTS). For each parameter, Eff.Sample 
## is a crude measure of effective sample size, and Rhat is the potential 
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>In regression models, we typically use predictor variables to explain variation in our criterion variables. It’s pretty much never the case that our predictors explain all the variation. The variation that’s left over is often called residual variation, residual variance, residuals, error, or even <span class="math inline">\(\epsilon\)</span>. Throughout the text, Hayes typically referred to it as <span class="math inline">\(e\)</span>.</p>
<p>More formally, when we use likelihood-based estimators, such as maximum likelihood (popular with multilevel modeling and structural equation modeling) or Bayesian estimators, we express the models for our criterion variables in terms of likelihood functions. Probably the most common likelihood function, and the one consistent with the models in Hayes’s text, is the Gaussian likelihood. With that likelihood we say our criterion variable <span class="math inline">\(y_i\)</span> is normally distributed with a mean <span class="math inline">\(\mu\)</span> and standard deviation <span class="math inline">\(\sigma\)</span>. We might express that formally as</p>
<p><span class="math display">\[
y_i \sim \text{Normal} (\mu, \sigma),
\]</span></p>
<p>where <span class="math inline">\(\sim\)</span> stands for “is distributed as” and <span class="math inline">\(i\)</span> indexes the <span class="math inline">\(i^\text{th}\)</span> row in the data. When we add predictors to the model, they are typically used to model the mean <span class="math inline">\(\mu\)</span>. Thus, in the case there we have a sole predictor <span class="math inline">\(x_i\)</span> which varies across participants, we’d expand our model formula to</p>
<p><span class="math display">\[\begin{align*}
y_i &amp; \sim \text{Normal} (\mu_i, \sigma) \\
\mu_i &amp; = \beta_0 + \beta_1 x_i,
\end{align*}\]</span></p>
<p>where <span class="math inline">\(\beta_0\)</span> is the intercept and <span class="math inline">\(\beta_1\)</span> is the slope for predictor <span class="math inline">\(x\)</span>, which varies across cases. In this formulation, <span class="math inline">\(\sigma\)</span> is the standard deviation after accounting for the systemic variation explained by <span class="math inline">\(x_i\)</span>. That is, it’s the residual variance (i.e., <span class="math inline">\(\epsilon\)</span>), but in a standard-deviation metric. <em>Why in a standard deviation metric?</em>, you ask. There are technical reasons why <strong>brms</strong> expresses it as a standard deviation which I’m not going to go into, here. Just beware that whereas many frequentist software packages express the residual variation in a variance metric, it’s expressed in a standard-deviation metric in <strong>brms</strong>. Just go with it and move on.</p>
<p>Within the <strong>brms</strong> framework, <span class="math inline">\(\sigma\)</span> of the Gaussian likelihood is considered a “family-specific” parameter. As it turns out, there are many other fine likelihood functions in addition to the Gaussian and not all of them have a <span class="math inline">\(\sigma\)</span> parameter. For example, there is no <span class="math inline">\(\sigma\)</span> for the Poisson <a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> distribution, which is popular likelihood function for count variables. Because Bürkner made the <strong>brms</strong> package capable of a variety of likelihood functions, it behooved him to give this section of the output a generic name.</p>
<p>When you have a regression model with multiple Gaussian criterion variables, those variables will typically have some degree of covariation. It’s often termed residual covariance, particularly within the structural equation modeling paradigm <a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a>. But when you have an intercept-only regression model with multiple variables, that residual covariance is just a covariance. And when you express those variation parameters in terms of standard deviations <span class="math inline">\(\sigma\)</span>, their covariance is expressed as a correlation <span class="math inline">\(\rho\)</span>. Since our multivariate model is of two variables, we have one <span class="math inline">\(\rho\)</span> parameter for the <span class="math inline">\(\sigma\)</span>s, <code>rescor(negemot,govact)</code>, which is our Bayesian analogue to the Pearson’s correlation.</p>
<p>To learn more about the multivariate syntax in <strong>brms</strong>, click <a href="https://cran.r-project.org/web/packages/brms/vignettes/brms_multivariate.html">here</a> or execute <code>vignette(&quot;brms_multivariate&quot;)</code>. Or just hold your horses until we get into mediation. All of our mediation models will use one version of the multivariate syntax or another.</p>
<p>But to clarify the output, above:</p>
<ul>
<li>‘Estimate’ = the posterior mean, analogous to the frequentist point estimate,</li>
<li>‘Est.Error’ = the posterior <span class="math inline">\(SD\)</span>, analogous to the frequentist standard error,</li>
<li>‘l-95% CI’ = the lower-level of the percentile-based 95% Bayesian credible interval, and</li>
<li>‘u-95% CI’ = the upper-level of the same.</li>
</ul>
</div>
<div id="the-simple-linear-regression-model" class="section level2">
<h2><span class="header-section-number">2.2</span> The simple linear regression model</h2>
<p>Here is how one might get the simple OLS coefficients in base <strong>R</strong> with the <code>lm()</code> function.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1">(model2<span class="fl">.2</span> &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="dt">data =</span> glbwarm, govact <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>negemot))</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = govact ~ 1 + negemot, data = glbwarm)
## 
## Coefficients:
## (Intercept)      negemot  
##      2.7573       0.5142</code></pre>
<p>For more detailed output, put the model object <code>model2.2</code> into the <code>summary()</code> function.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1"><span class="kw">summary</span>(model2<span class="fl">.2</span>)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = govact ~ 1 + negemot, data = glbwarm)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4.3285 -0.6731  0.1018  0.7554  3.2142 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  2.75732    0.09866   27.95   &lt;2e-16 ***
## negemot      0.51424    0.02548   20.18   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.111 on 813 degrees of freedom
## Multiple R-squared:  0.3338, Adjusted R-squared:  0.333 
## F-statistic: 407.3 on 1 and 813 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>Here’s the Bayesian model in <strong>brms</strong>.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1">model2<span class="fl">.3</span> &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb21-2" data-line-number="2"><span class="st">  </span><span class="kw">brm</span>(<span class="dt">data =</span> glbwarm, </a>
<a class="sourceLine" id="cb21-3" data-line-number="3">      <span class="dt">family =</span> gaussian,</a>
<a class="sourceLine" id="cb21-4" data-line-number="4">      govact <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>negemot,</a>
<a class="sourceLine" id="cb21-5" data-line-number="5">      <span class="dt">cores =</span> <span class="dv">4</span>)</a></code></pre></div>
<p>There are several ways to get a <strong>brms</strong> model summary. A go-to is with the <code>summary()</code> function, just like we did with our OLS model.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1"><span class="kw">summary</span>(model2<span class="fl">.3</span>)</a></code></pre></div>
<pre><code>##  Family: gaussian 
##   Links: mu = identity; sigma = identity 
## Formula: govact ~ 1 + negemot 
##    Data: glbwarm (Number of observations: 815) 
## Samples: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
##          total post-warmup samples = 4000
## 
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept     2.76      0.10     2.56     2.95 1.00     3899     2636
## negemot       0.51      0.03     0.47     0.56 1.00     3976     2642
## 
## Family Specific Parameters: 
##       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sigma     1.11      0.03     1.06     1.17 1.00     3833     3304
## 
## Samples were drawn using sampling(NUTS). For each parameter, Eff.Sample 
## is a crude measure of effective sample size, and Rhat is the potential 
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>The <code>print()</code> function works very much the same way. To get a more focused look, you can use the <code>posterior_summary()</code> function:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1"><span class="kw">posterior_summary</span>(model2<span class="fl">.3</span>)</a></code></pre></div>
<pre><code>##                  Estimate  Est.Error          Q2.5         Q97.5
## b_Intercept     2.7586363 0.09823326     2.5641513     2.9473085
## b_negemot       0.5138856 0.02515461     0.4651076     0.5638099
## sigma           1.1129151 0.02782781     1.0607317     1.1688957
## lp__        -1248.6113700 1.22961873 -1251.8462595 -1247.2203071</code></pre>
<p>That also yields the log posterior, <code>lp__</code>, which you can learn more about <a href="https://cran.r-project.org/web/packages/rstan/vignettes/rstan.html#the-log-posterior-function-and-gradient">here</a> or <a href="https://www.jax.org/news-and-insights/jax-blog/2015/october/lp-in-stan-output">here</a>. We won’t focus on the <code>lp__</code> directly in this project. But its influence will be lurking in the shadows.</p>
<p>But anyways, the <code>Q2.5</code> and <code>Q97.5</code>, are the lower- and upper-levels of the 95% credible intervals. The <code>Q</code> prefix stands for quantile (<a href="https://github.com/paul-buerkner/brms/issues/425">see this thread</a>). In this case, these are a renamed version of the <code>l-95% CI</code> and <code>u-95% CI</code> columns from our <code>summary()</code> output.</p>
<p>To make a quick plot of the regression line, one can use the convenient <code>brms::conditional_effects()</code> function.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" data-line-number="1"><span class="kw">conditional_effects</span>(model2<span class="fl">.3</span>)</a></code></pre></div>
<p><img src="02_files/figure-html/unnamed-chunk-15-1.png" width="432" /></p>
<p>If you want to customize that output, you might nest it in <code>plot()</code>.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" data-line-number="1"><span class="kw">plot</span>(<span class="kw">conditional_effects</span>(model2<span class="fl">.3</span>),</a>
<a class="sourceLine" id="cb27-2" data-line-number="2">     <span class="dt">points =</span> T,</a>
<a class="sourceLine" id="cb27-3" data-line-number="3">     <span class="dt">point_args =</span> <span class="kw">c</span>(<span class="dt">height =</span> <span class="fl">.05</span>, <span class="dt">width =</span> <span class="fl">.05</span>, </a>
<a class="sourceLine" id="cb27-4" data-line-number="4">                    <span class="dt">alpha =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>, <span class="dt">size =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">3</span>))</a></code></pre></div>
<p><img src="02_files/figure-html/unnamed-chunk-16-1.png" width="432" /></p>
<p>It’s also useful to be able to work with the output of a <strong>brms</strong> model directly. For our first step, we’ll put our posterior draws into a data frame with the <code>posterior_samples()</code> function.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" data-line-number="1">post &lt;-<span class="st"> </span><span class="kw">posterior_samples</span>(model2<span class="fl">.3</span>)</a>
<a class="sourceLine" id="cb28-2" data-line-number="2"></a>
<a class="sourceLine" id="cb28-3" data-line-number="3"><span class="kw">head</span>(post)</a></code></pre></div>
<pre><code>##   b_Intercept b_negemot    sigma      lp__
## 1    2.746242 0.5070495 1.060411 -1249.422
## 2    2.791774 0.5103668 1.136106 -1247.674
## 3    2.884980 0.4800574 1.081211 -1248.660
## 4    2.815726 0.4967236 1.098271 -1247.455
## 5    2.735722 0.5223162 1.083676 -1247.670
## 6    2.698650 0.5447054 1.100676 -1248.731</code></pre>
<p>Next, we’ll use the <code>fitted()</code> function to simulate model-implied summaries for the expected <code>govact</code> value, given particular predictor values. Our first model only has <code>negemot</code> as a predictor, and we’ll ask for the expected <code>govact</code> values for <code>negemot</code> ranging from 0 to 7.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" data-line-number="1">nd &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">negemot =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">7</span>, <span class="dt">length.out =</span> <span class="dv">30</span>))</a>
<a class="sourceLine" id="cb30-2" data-line-number="2"></a>
<a class="sourceLine" id="cb30-3" data-line-number="3">f &lt;-</a>
<a class="sourceLine" id="cb30-4" data-line-number="4"><span class="st">  </span><span class="kw">fitted</span>(model2<span class="fl">.3</span>,</a>
<a class="sourceLine" id="cb30-5" data-line-number="5">         <span class="dt">newdata =</span> nd) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb30-6" data-line-number="6"><span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb30-7" data-line-number="7"><span class="st">  </span><span class="kw">bind_cols</span>(nd)</a>
<a class="sourceLine" id="cb30-8" data-line-number="8"></a>
<a class="sourceLine" id="cb30-9" data-line-number="9"><span class="kw">head</span>(f)</a></code></pre></div>
<pre><code>##   Estimate  Est.Error     Q2.5    Q97.5   negemot
## 1 2.758636 0.09823326 2.564151 2.947309 0.0000000
## 2 2.882678 0.09270198 2.699714 3.061210 0.2413793
## 3 3.006719 0.08724263 2.835814 3.175164 0.4827586
## 4 3.130760 0.08186959 2.971287 3.288608 0.7241379
## 5 3.254802 0.07660101 3.105377 3.402664 0.9655172
## 6 3.378843 0.07146002 3.240015 3.517081 1.2068966</code></pre>
<p>The first two columns should look familiar to the output from <code>summary(model2.3)</code>, above. The next two columns, <code>Q2.5</code> and <code>Q97.5</code>, are the lower- and upper-levels of the 95% credible intervals, like we got from <code>posterior_samples()</code>. The final column is the result of the <code>bind_cols(nd)</code> code.</p>
<p>Here’s our bespoke version of Figure 2.4.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" data-line-number="1">glbwarm <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb32-2" data-line-number="2"><span class="st">  </span><span class="kw">group_by</span>(negemot, govact) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb32-3" data-line-number="3"><span class="st">  </span><span class="kw">count</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb32-4" data-line-number="4"><span class="st">  </span></a>
<a class="sourceLine" id="cb32-5" data-line-number="5"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> negemot)) <span class="op">+</span></a>
<a class="sourceLine" id="cb32-6" data-line-number="6"><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">y =</span> govact, <span class="dt">size =</span> n),</a>
<a class="sourceLine" id="cb32-7" data-line-number="7">             <span class="dt">show.legend =</span> F) <span class="op">+</span></a>
<a class="sourceLine" id="cb32-8" data-line-number="8"><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="dt">data =</span> f,</a>
<a class="sourceLine" id="cb32-9" data-line-number="9">              <span class="kw">aes</span>(<span class="dt">ymin =</span> Q2<span class="fl">.5</span>,</a>
<a class="sourceLine" id="cb32-10" data-line-number="10">                  <span class="dt">ymax =</span> Q97<span class="fl">.5</span>),</a>
<a class="sourceLine" id="cb32-11" data-line-number="11">              <span class="dt">fill =</span> <span class="st">&quot;grey75&quot;</span>, <span class="dt">alpha =</span> <span class="dv">3</span><span class="op">/</span><span class="dv">4</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb32-12" data-line-number="12"><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">data =</span> f,</a>
<a class="sourceLine" id="cb32-13" data-line-number="13">            <span class="kw">aes</span>(<span class="dt">y =</span> Estimate)) <span class="op">+</span></a>
<a class="sourceLine" id="cb32-14" data-line-number="14"><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="fl">2.2</span>, <span class="dt">y =</span> <span class="fl">7.5</span>, <span class="dt">label =</span> <span class="st">&quot;Cases with positive residuals&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;red3&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb32-15" data-line-number="15"><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="fl">4.75</span>, <span class="dt">y =</span> <span class="fl">.8</span>, <span class="dt">label =</span> <span class="st">&quot;Cases with negative residuals&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;blue3&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb32-16" data-line-number="16"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;NEGEMOT: Negative emotions about climate change (&quot;</span>, <span class="kw">italic</span>(<span class="st">&quot;X&quot;</span>), <span class="st">&quot;)&quot;</span>)),</a>
<a class="sourceLine" id="cb32-17" data-line-number="17">       <span class="dt">y =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;GOVACT: Support for governmentaction (&quot;</span>, <span class="kw">italic</span>(<span class="st">&quot;Y&quot;</span>), <span class="st">&quot;)&quot;</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb32-18" data-line-number="18"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">range</span>(glbwarm<span class="op">$</span>negemot)) <span class="op">+</span></a>
<a class="sourceLine" id="cb32-19" data-line-number="19"><span class="st">  </span><span class="kw">theme_bw</span>()</a></code></pre></div>
<p><img src="02_files/figure-html/unnamed-chunk-19-1.png" width="480" /></p>
<p>Note how that figure is a combination of the original <code>glbwarm</code> data and our <code>f</code> output.</p>
<div id="interpretation-of-the-constant-and-regression-coefficient." class="section level3">
<h3><span class="header-section-number">2.2.1</span> Interpretation of the constant and regression coefficient.</h3>
<p>“The regression constant is conceptually equivalent to the <span class="math inline">\(Y\)</span>-intercept in the equation for a line. It quantifies the estimated value of <span class="math inline">\(Y\)</span> when <span class="math inline">\(X = 0\)</span>” (p. 39).</p>
</div>
<div id="the-standardized-regression-model." class="section level3">
<h3><span class="header-section-number">2.2.2</span> The standardized regression model.</h3>
<blockquote>
<p>Thus far, the interpretation of the regression coefficients in a regression model has been couched in <em>unstandardized</em> or <em>raw metric</em> form. Many regression routines will also produce a version of the model in <em>standardized</em> form. The standardized regression model is what results when all variables are first standardized prior to estimation of the model by expressing each measurement in units of standard deviations from the sample mean. (p. 40, <em>emphasis</em> in the original)</p>
</blockquote>
<p><strong>brms</strong> will not produce standardized solutions on the fly. To get them, you will have to manually standardize the variables before entering them into the model.</p>
</div>
<div id="simple-linear-regression-with-a-dichotomous-antecedent-variable." class="section level3">
<h3><span class="header-section-number">2.2.3</span> Simple linear regression with a dichotomous antecedent variable.</h3>
<p>In the <code>glbwarm</code> data, <code>sex</code> is a dichotomous variable.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" data-line-number="1">glbwarm <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb33-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> sex)) <span class="op">+</span></a>
<a class="sourceLine" id="cb33-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_bar</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb33-4" data-line-number="4"><span class="st">  </span><span class="kw">theme_bw</span>()</a></code></pre></div>
<p><img src="02_files/figure-html/unnamed-chunk-20-1.png" width="384" /></p>
<p>In these data, <code>sex</code> is coded females = 0, males = 1. Here we add <code>sex</code> to the model.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" data-line-number="1">model2<span class="fl">.4</span> &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb34-2" data-line-number="2"><span class="st">  </span><span class="kw">brm</span>(<span class="dt">data =</span> glbwarm, </a>
<a class="sourceLine" id="cb34-3" data-line-number="3">      <span class="dt">family =</span> gaussian,</a>
<a class="sourceLine" id="cb34-4" data-line-number="4">      govact <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>sex,</a>
<a class="sourceLine" id="cb34-5" data-line-number="5">      <span class="dt">cores =</span> <span class="dv">4</span>)</a></code></pre></div>
<p>Check the summary.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" data-line-number="1"><span class="kw">print</span>(model2<span class="fl">.4</span>)</a></code></pre></div>
<pre><code>##  Family: gaussian 
##   Links: mu = identity; sigma = identity 
## Formula: govact ~ 1 + sex 
##    Data: glbwarm (Number of observations: 815) 
## Samples: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
##          total post-warmup samples = 4000
## 
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept     4.72      0.07     4.59     4.85 1.00     4737     3203
## sex          -0.27      0.10    -0.45    -0.08 1.00     4388     3046
## 
## Family Specific Parameters: 
##       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sigma     1.36      0.03     1.29     1.43 1.00     4878     3019
## 
## Samples were drawn using sampling(NUTS). For each parameter, Eff.Sample 
## is a crude measure of effective sample size, and Rhat is the potential 
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>Our model summary is very close to that in the text. If you just wanted the coefficients, you might use the <code>fixef()</code> function.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" data-line-number="1"><span class="kw">fixef</span>(model2<span class="fl">.4</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">round</span>(<span class="dt">digits =</span> <span class="dv">3</span>)</a></code></pre></div>
<pre><code>##           Estimate Est.Error   Q2.5  Q97.5
## Intercept    4.719     0.067  4.589  4.853
## sex         -0.270     0.096 -0.455 -0.079</code></pre>
<p>Though not necessary, we used the <code>round()</code> function to reduce the number of significant digits in the output. You can get a little more information with the <code>posterior_summary()</code> function.</p>
<p>But since Bayesian estimation yields an entire posterior distribution, you can visualize that distribution in any number of ways. Because we’ll be using <strong>ggplot2</strong>, we’ll need to put the posterior draws into a data frame before plotting.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" data-line-number="1">post &lt;-<span class="st"> </span><span class="kw">posterior_samples</span>(model2<span class="fl">.4</span>)</a></code></pre></div>
<p>We could summarize the posterior with boxplots</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" data-line-number="1">post <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb40-2" data-line-number="2"><span class="st">  </span><span class="kw">rename</span>(<span class="dt">female =</span> b_Intercept) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb40-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">male =</span> female <span class="op">+</span><span class="st"> </span>b_sex) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb40-4" data-line-number="4"><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="kw">c</span>(male, female)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb40-5" data-line-number="5"><span class="st">  </span></a>
<a class="sourceLine" id="cb40-6" data-line-number="6"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> name, <span class="dt">y =</span> value)) <span class="op">+</span></a>
<a class="sourceLine" id="cb40-7" data-line-number="7"><span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> name)) <span class="op">+</span></a>
<a class="sourceLine" id="cb40-8" data-line-number="8"><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb40-9" data-line-number="9"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)</a></code></pre></div>
<p><img src="02_files/figure-html/unnamed-chunk-25-1.png" width="288" /></p>
<p>or with overlapping density plots</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" data-line-number="1">post <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb41-2" data-line-number="2"><span class="st">  </span><span class="kw">rename</span>(<span class="dt">female =</span> b_Intercept) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb41-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">male =</span> female <span class="op">+</span><span class="st"> </span>b_sex) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb41-4" data-line-number="4"><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="kw">c</span>(male, female)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb41-5" data-line-number="5"><span class="st">  </span></a>
<a class="sourceLine" id="cb41-6" data-line-number="6"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> value, <span class="dt">group =</span> name, <span class="dt">fill =</span> name)) <span class="op">+</span></a>
<a class="sourceLine" id="cb41-7" data-line-number="7"><span class="st">  </span><span class="kw">geom_density</span>(<span class="dt">color =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">alpha =</span> <span class="dv">3</span><span class="op">/</span><span class="dv">4</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb41-8" data-line-number="8"><span class="st">  </span><span class="kw">theme_bw</span>()</a></code></pre></div>
<p><img src="02_files/figure-html/unnamed-chunk-26-1.png" width="384" /></p>
<p>or even with violin plots with superimposed posterior medians and 95% intervals.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" data-line-number="1">post <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb42-2" data-line-number="2"><span class="st">  </span><span class="kw">rename</span>(<span class="dt">female =</span> b_Intercept) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb42-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">male =</span> female <span class="op">+</span><span class="st"> </span>b_sex) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb42-4" data-line-number="4"><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="kw">c</span>(male, female)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb42-5" data-line-number="5"><span class="st">  </span></a>
<a class="sourceLine" id="cb42-6" data-line-number="6"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> name, <span class="dt">y =</span> value)) <span class="op">+</span></a>
<a class="sourceLine" id="cb42-7" data-line-number="7"><span class="st">  </span><span class="kw">geom_violin</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> name), <span class="dt">color =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">alpha =</span> <span class="dv">3</span><span class="op">/</span><span class="dv">4</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb42-8" data-line-number="8"><span class="st">  </span><span class="kw">stat_summary</span>(<span class="dt">fun.y =</span> median,</a>
<a class="sourceLine" id="cb42-9" data-line-number="9">               <span class="dt">fun.ymin =</span> <span class="cf">function</span>(i){<span class="kw">quantile</span>(i, <span class="dt">probs =</span> <span class="fl">.025</span>)},</a>
<a class="sourceLine" id="cb42-10" data-line-number="10">               <span class="dt">fun.ymax =</span> <span class="cf">function</span>(i){<span class="kw">quantile</span>(i, <span class="dt">probs =</span> <span class="fl">.975</span>)}) <span class="op">+</span></a>
<a class="sourceLine" id="cb42-11" data-line-number="11"><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb42-12" data-line-number="12"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)</a></code></pre></div>
<p><img src="02_files/figure-html/unnamed-chunk-27-1.png" width="288" /></p>
<p>For even more ideas, see <a href="https://twitter.com/mjskay">Matthew Kay</a>’s <a href="https://mjskay.github.io/tidybayes/articles/tidybayes.html"><strong>tidybayes</strong> package</a>.</p>
<p>As Hayes discussed on page 42, you can also get a sense of the model estimates for women and men with a little addition. Here we continue to use the <code>round()</code> function to simplify the output.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" data-line-number="1"><span class="co"># for women</span></a>
<a class="sourceLine" id="cb43-2" data-line-number="2"><span class="kw">round</span>(<span class="kw">fixef</span>(model2<span class="fl">.4</span>)[<span class="dv">1</span>, ], <span class="dt">digits =</span> <span class="dv">2</span>)</a></code></pre></div>
<pre><code>##  Estimate Est.Error      Q2.5     Q97.5 
##      4.72      0.07      4.59      4.85</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" data-line-number="1"><span class="co"># for men</span></a>
<a class="sourceLine" id="cb45-2" data-line-number="2"><span class="kw">round</span>(<span class="kw">fixef</span>(model2<span class="fl">.4</span>)[<span class="dv">1</span>, ] <span class="op">+</span><span class="st"> </span><span class="kw">fixef</span>(model2<span class="fl">.4</span>)[<span class="dv">2</span>, ], <span class="dt">digits =</span> <span class="dv">2</span>)</a></code></pre></div>
<pre><code>##  Estimate Est.Error      Q2.5     Q97.5 
##      4.45      0.16      4.13      4.77</code></pre>
<p>Hayes then considered that</p>
<blockquote>
<p>although the model will always generate the group means, the regression coefficient and regression constant will depend on how the two groups are coded. For instance, suppose females were coded <span class="math inline">\(X = −1\)</span> and males were coded <span class="math inline">\(X = 1\)</span>. (p. 42)</p>
</blockquote>
<p>To follow along, we’ll first recode <code>sex</code>, saving it as <code>sex_recode</code>.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" data-line-number="1">glbwarm &lt;-</a>
<a class="sourceLine" id="cb47-2" data-line-number="2"><span class="st">  </span>glbwarm <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb47-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sex_recode =</span> <span class="kw">if_else</span>(sex <span class="op">==</span><span class="st"> </span><span class="dv">0</span>, <span class="dv">-1</span>, <span class="dv">1</span>))</a></code></pre></div>
<p>Now fit the new model.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" data-line-number="1">model2<span class="fl">.5</span> &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb48-2" data-line-number="2"><span class="st">  </span><span class="kw">brm</span>(<span class="dt">data =</span> glbwarm, </a>
<a class="sourceLine" id="cb48-3" data-line-number="3">      <span class="dt">family =</span> gaussian,</a>
<a class="sourceLine" id="cb48-4" data-line-number="4">      govact <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>sex_recode,</a>
<a class="sourceLine" id="cb48-5" data-line-number="5">      <span class="dt">cores =</span> <span class="dv">4</span>)</a></code></pre></div>
<p>Check the primary coefficients.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" data-line-number="1"><span class="kw">fixef</span>(model2<span class="fl">.5</span>)</a></code></pre></div>
<pre><code>##             Estimate  Est.Error       Q2.5       Q97.5
## Intercept   4.584837 0.04871590  4.4879171  4.67992636
## sex_recode -0.134560 0.04764951 -0.2259731 -0.04023795</code></pre>
<p>They match up well with the results in the middle of page 42. Now the <code>Intercept</code> in the output, what Hayes called <span class="math inline">\(i_Y\)</span> is the unweighted mean of the means, <span class="math inline">\((\overline Y_\text{male} + \overline Y_\text{female}) / 2\)</span>, and the coefficient <code>sex_recode</code> (i.e., what Hayes called <span class="math inline">\(b\)</span>) is one half the difference between those means. Here’s how to work with the posterior draws from this model to reproduce the group mean estimates.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" data-line-number="1"><span class="kw">posterior_samples</span>(model2<span class="fl">.5</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb51-2" data-line-number="2"><span class="st">  </span><span class="kw">transmute</span>(<span class="dt">male   =</span> b_Intercept <span class="op">+</span><span class="st"> </span>b_sex_recode <span class="op">*</span><span class="st"> </span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb51-3" data-line-number="3">            <span class="dt">female =</span> b_Intercept <span class="op">+</span><span class="st"> </span>b_sex_recode <span class="op">*</span><span class="st"> </span><span class="dv">-1</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb51-4" data-line-number="4"><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="kw">everything</span>()) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb51-5" data-line-number="5"></a>
<a class="sourceLine" id="cb51-6" data-line-number="6"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> value, <span class="dt">group =</span> name, <span class="dt">fill =</span> name)) <span class="op">+</span></a>
<a class="sourceLine" id="cb51-7" data-line-number="7"><span class="st">  </span><span class="kw">geom_density</span>(<span class="dt">color =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">alpha =</span> <span class="dv">3</span><span class="op">/</span><span class="dv">4</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb51-8" data-line-number="8"><span class="st">  </span><span class="kw">theme_bw</span>()</a></code></pre></div>
<p><img src="02_files/figure-html/unnamed-chunk-32-1.png" width="384" /></p>
<p>You’ll see it looks just like the plot from above.</p>
<div id="a-caution-about-the-standardized-regression-coefficient." class="section level4">
<h4><span class="header-section-number">2.2.3.1</span> A caution about the standardized regression coefficient.</h4>
<blockquote>
<p>The standardized regression coefficient is a function of both the mean difference and the distribution of the cases across the groups. This is an undesirable property of <span class="math inline">\(\tilde b\)</span> when <span class="math inline">\(X\)</span> is dichotomous. <em>I recommend that the standardized regression coefficient for a dichotomous antecedent variable not be interpreted or reported</em>.</p>
<p>If you desire an index of a mean difference in standard deviation units, I recommend standardizing <span class="math inline">\(Y\)</span> but not the dichotomous <span class="math inline">\(X\)</span> and then interpreting the <em>unstandardized</em> regression coefficient in a model estimating <span class="math inline">\(Z_Y\)</span> from <span class="math inline">\(X\)</span>. In such a model, <span class="math inline">\(b\)</span> is a <em>partially</em> standardized regression coefficient. (pp. 43–44, <em>emphasis</em> in the original)</p>
</blockquote>
<p>Here’s how to fit the partially-standardized model, first with <code>lm()</code>.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" data-line-number="1"><span class="co"># standardize the Y</span></a>
<a class="sourceLine" id="cb52-2" data-line-number="2">glbwarm &lt;-</a>
<a class="sourceLine" id="cb52-3" data-line-number="3"><span class="st">  </span>glbwarm <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb52-4" data-line-number="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">govact_z =</span> (govact <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(govact)) <span class="op">/</span><span class="st"> </span><span class="kw">sd</span>(govact))</a>
<a class="sourceLine" id="cb52-5" data-line-number="5"></a>
<a class="sourceLine" id="cb52-6" data-line-number="6"><span class="co"># fit the model</span></a>
<a class="sourceLine" id="cb52-7" data-line-number="7"><span class="kw">lm</span>(<span class="dt">data =</span> glbwarm, govact_z <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>sex)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = govact_z ~ 1 + sex, data = glbwarm)
## 
## Coefficients:
## (Intercept)          sex  
##     0.09629     -0.19717</code></pre>
<p>Now we’ll fit the model as Bayesians with <code>brms::brm()</code>.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" data-line-number="1">model2<span class="fl">.6</span> &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb54-2" data-line-number="2"><span class="st">  </span><span class="kw">brm</span>(<span class="dt">data =</span> glbwarm, </a>
<a class="sourceLine" id="cb54-3" data-line-number="3">      <span class="dt">family =</span> gaussian,</a>
<a class="sourceLine" id="cb54-4" data-line-number="4">      govact_z <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>sex,</a>
<a class="sourceLine" id="cb54-5" data-line-number="5">      <span class="dt">cores =</span> <span class="dv">4</span>)</a></code></pre></div>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" data-line-number="1"><span class="kw">fixef</span>(model2<span class="fl">.6</span>)</a></code></pre></div>
<pre><code>##             Estimate  Est.Error        Q2.5       Q97.5
## Intercept  0.0949203 0.04989422 -0.00281135  0.19336975
## sex       -0.1949099 0.07008134 -0.32958274 -0.05282248</code></pre>
<blockquote>
<p>The constant <span class="math inline">\(i_Y\)</span> is the mean standardized <span class="math inline">\(Y\)</span> for females, and <span class="math inline">\(b\)</span> is the mean difference between males and females in standard deviations of <span class="math inline">\(Y\)</span>. So men are estimated to differ from women by 0.197 standard deviations in their support for government action. The negative sign for <span class="math inline">\(b\)</span> means males are lower than females, on average, in their support. (p. 44)</p>
</blockquote>
<p>The result from our Bayesian model was the same as the OLS results up to two decimal places. This will often be the case. One is not more correct. They are the results of using different procedures.</p>
</div>
</div>
<div id="a-note-on-symbolic-representations." class="section level3">
<h3><span class="header-section-number">2.2.4</span> A note on symbolic representations.</h3>
<p>This section is worthy of repeating in full.</p>
<blockquote>
<p>A brief digression is in order at this point. It is important when reporting the results of an analysis to define the symbols you use unless there is a strong convention, for a failure to do so can invite confusion. Different uses of <span class="math inline">\(b\)</span> and <span class="math inline">\(\beta\)</span> in regression analysis are an important case in point. There is much inconsistency in the substantive and methodology literature as to how regression coefficients are symbolized in unstandardized versus standardized form. Some use <span class="math inline">\(b\)</span> or <span class="math inline">\(B\)</span> to refer to the unstandardized regression coefficient and <span class="math inline">\(\beta\)</span> to refer to the standardized regression coefficient. Others, rather than using <span class="math inline">\(\beta\)</span>, spell it out by referencing “beta weights” or just talk about the “betas.” Some use <span class="math inline">\(\beta\)</span> to refer to a population regression coefficient, to distinguish it from a sample estimate, others use <span class="math inline">\(\beta\)</span> as the unstandardized regression weight, and there are still others who use <span class="math inline">\(\hat \beta\)</span> to refer to a sample unstandardized regression coefficient and leave the hat off for its corresponding population or “true” value. In this book, I use <span class="math inline">\(\tilde \beta\)</span> for the standardized regression weight.</p>
<p>Ultimately, the symbols we use are for the most part arbitrary. We can use any symbols we want. My point is that you should not assume others will know what symbols you use mean, for your familiar symbols to represent certain concepts may not be understood as representing those concepts by all. The same applies to terms such as “beta coefficient” or other verbalizations of symbols. Best to define your symbols in advance, or otherwise let your reader know what your symbols mean when used in text and tables. This will help others better understand and interpret your work. (p. 44)</p>
</blockquote>
</div>
</div>
<div id="alternative-explanations-for-association" class="section level2">
<h2><span class="header-section-number">2.3</span> Alternative explanations for association</h2>
<blockquote>
<p>That “correlation does not imply causation” is etched into the brains of all scientists. If variables <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are correlated, that doesn’t mean that <span class="math inline">\(X\)</span> causes <span class="math inline">\(Y\)</span> or that <span class="math inline">\(Y\)</span> causes <span class="math inline">\(X\)</span>. The ability to infer cause–effect is not even a statistical matter in the end. Rather, it is the design of one’s study, the data collection procedures one employs, and theoretical plausibility that most directly influence whether a cause–effect claim can be made and with what degree of confidence, not the size or sign of a statistical index of association. (p. 45)</p>
</blockquote>
<p>On page 46, Hayes produced a couple correlations. Here’s how to get them from base <strong>R</strong>.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb57-1" data-line-number="1"><span class="kw">cor</span>(glbwarm<span class="op">$</span>sex, glbwarm<span class="op">$</span>negemot)</a></code></pre></div>
<pre><code>## [1] -0.1173564</code></pre>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb59-1" data-line-number="1"><span class="kw">cor</span>(glbwarm<span class="op">$</span>sex, glbwarm<span class="op">$</span>govact)</a></code></pre></div>
<pre><code>## [1] -0.09861854</code></pre>
<p>Again, if we wanted to get full Bayesian estimates, we’d fit an intercept-only multivariate model.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb61-1" data-line-number="1">model2<span class="fl">.7</span> &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb61-2" data-line-number="2"><span class="st">  </span><span class="kw">brm</span>(<span class="dt">data =</span> glbwarm, </a>
<a class="sourceLine" id="cb61-3" data-line-number="3">      <span class="dt">family =</span> gaussian,</a>
<a class="sourceLine" id="cb61-4" data-line-number="4">      <span class="kw">mvbind</span>(negemot, govact, sex) <span class="op">~</span><span class="st"> </span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb61-5" data-line-number="5">      <span class="dt">cores =</span> <span class="dv">4</span>)</a></code></pre></div>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb62-1" data-line-number="1"><span class="kw">print</span>(model2<span class="fl">.7</span>, <span class="dt">digits =</span> <span class="dv">3</span>)</a></code></pre></div>
<pre><code>##  Family: MV(gaussian, gaussian, gaussian) 
##   Links: mu = identity; sigma = identity
##          mu = identity; sigma = identity
##          mu = identity; sigma = identity 
## Formula: negemot ~ 1 
##          govact ~ 1 
##          sex ~ 1 
##    Data: glbwarm (Number of observations: 815) 
## Samples: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
##          total post-warmup samples = 4000
## 
## Population-Level Effects: 
##                   Estimate Est.Error l-95% CI u-95% CI  Rhat Bulk_ESS Tail_ESS
## negemot_Intercept    3.557     0.054    3.450    3.663 1.000     5294     3105
## govact_Intercept     4.586     0.048    4.492    4.680 1.001     5602     3064
## sex_Intercept        0.489     0.018    0.453    0.523 1.000     7096     2955
## 
## Family Specific Parameters: 
##               Estimate Est.Error l-95% CI u-95% CI  Rhat Bulk_ESS Tail_ESS
## sigma_negemot    1.533     0.038    1.458    1.609 1.001     4743     3266
## sigma_govact     1.364     0.034    1.297    1.436 1.000     4588     2923
## sigma_sex        0.502     0.012    0.478    0.527 1.001     6214     2739
## 
## Residual Correlations: 
##                        Estimate Est.Error l-95% CI u-95% CI  Rhat Bulk_ESS Tail_ESS
## rescor(negemot,govact)    0.577     0.024    0.528    0.622 1.001     4639     3367
## rescor(negemot,sex)      -0.116     0.034   -0.184   -0.046 1.000     6996     3104
## rescor(govact,sex)       -0.098     0.034   -0.166   -0.033 1.000     6045     3114
## 
## Samples were drawn using sampling(NUTS). For each parameter, Eff.Sample 
## is a crude measure of effective sample size, and Rhat is the potential 
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>For our purposes, the action is in the ‘rescor(<span class="math inline">\(i\)</span>, <span class="math inline">\(j\)</span>)’ portions of the ‘Family Specific Parameters’ section.</p>
<p>Anyway, if you wanted to get all the Pearson’s correlations among the <code>glbwarm</code> variables, rather than piecewise <code>cor()</code> approach, you could use the <code>lowerCor()</code> function from the <a href="https://cran.r-project.org/web/packages/psych/index.html"><strong>psych</strong> package</a>.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb64-1" data-line-number="1">psych<span class="op">::</span><span class="kw">lowerCor</span>(glbwarm[, <span class="dv">1</span><span class="op">:</span><span class="dv">7</span>], <span class="dt">digits =</span> <span class="dv">3</span>)</a></code></pre></div>
<pre><code>##          govact posemt negemt idelgy age    sex    partyd
## govact    1.000                                          
## posemot   0.043  1.000                                   
## negemot   0.578  0.128  1.000                            
## ideology -0.418 -0.029 -0.349  1.000                     
## age      -0.097  0.042 -0.057  0.212  1.000              
## sex      -0.099  0.074 -0.117  0.133  0.166  1.000       
## partyid  -0.360 -0.036 -0.324  0.619  0.154  0.109  1.000</code></pre>
</div>
<div id="multiple-linear-regression" class="section level2">
<h2><span class="header-section-number">2.4</span> Multiple linear regression</h2>
<blockquote>
<p>The simple linear regression model is easily extended to the estimation of a consequent variable using more than one antecedent variable. Including more than one antecedent in a regression model allows you to simultaneously investigate the role of multiple influences on a consequent variable. An additional and important benefit of the multiple regression model is that it provides various measures of <em>partial association</em> that quantify the component of the association between an antecedent and a consequent that is unique to that antecedent relative to other antecedent variables in the model. (p. 48, <em>emphasis</em> in the original)</p>
</blockquote>
<p>Using Hayes’ notation, the model we’re about follows the basic equation</p>
<p><span class="math display">\[\hat Y = i_Y + b_1 X_1 + b_2 X_2 + b_3 X_3 + b_4 X_4 + b_4 X_5.\]</span></p>
<p>For us, there’s technically more involved because our Bayesian paradigm includes priors, which we’re not focusing on at the moment. Anyway, there’s nothing particularly special about jumping from univariable to multivariable models with <strong>brms</strong>. You just keep tacking on predictors with the <code>+</code> operator.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb66-1" data-line-number="1">model2<span class="fl">.8</span> &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb66-2" data-line-number="2"><span class="st">  </span><span class="kw">brm</span>(<span class="dt">data =</span> glbwarm, </a>
<a class="sourceLine" id="cb66-3" data-line-number="3">      <span class="dt">family =</span> gaussian,</a>
<a class="sourceLine" id="cb66-4" data-line-number="4">      govact <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>negemot <span class="op">+</span><span class="st"> </span>posemot <span class="op">+</span><span class="st"> </span>ideology <span class="op">+</span><span class="st"> </span>sex <span class="op">+</span><span class="st"> </span>age,</a>
<a class="sourceLine" id="cb66-5" data-line-number="5">      <span class="dt">cores =</span> <span class="dv">4</span>)</a></code></pre></div>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb67-1" data-line-number="1"><span class="kw">print</span>(model2<span class="fl">.8</span>)</a></code></pre></div>
<pre><code>##  Family: gaussian 
##   Links: mu = identity; sigma = identity 
## Formula: govact ~ 1 + negemot + posemot + ideology + sex + age 
##    Data: glbwarm (Number of observations: 815) 
## Samples: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
##          total post-warmup samples = 4000
## 
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept     4.06      0.20     3.68     4.45 1.00     5191     3658
## negemot       0.44      0.03     0.39     0.49 1.00     4980     2981
## posemot      -0.03      0.03    -0.08     0.03 1.00     5830     3143
## ideology     -0.22      0.03    -0.27    -0.17 1.00     4484     3113
## sex          -0.01      0.08    -0.16     0.14 1.00     5623     2719
## age          -0.00      0.00    -0.01     0.00 1.00     5705     3159
## 
## Family Specific Parameters: 
##       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sigma     1.07      0.03     1.02     1.12 1.00     6039     2837
## 
## Samples were drawn using sampling(NUTS). For each parameter, Eff.Sample 
## is a crude measure of effective sample size, and Rhat is the potential 
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>Following Hayes on pages 50 and 51, here is the posterior mean (i.e., what you might call the Bayesian point estimate) for someone with</p>
<ul>
<li>negative emotions = 3,</li>
<li>positive emotions = 4,</li>
<li><code>ideology</code> = 2,</li>
<li>is male (i.e., <code>sex</code> = 1), and</li>
<li>is 30 years of <code>age</code>.</li>
</ul>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb69-1" data-line-number="1"><span class="kw">fixef</span>(model2<span class="fl">.8</span>)[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb69-2" data-line-number="2"><span class="st">  </span><span class="kw">fixef</span>(model2<span class="fl">.8</span>)[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span><span class="dv">3</span> <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb69-3" data-line-number="3"><span class="st">  </span><span class="kw">fixef</span>(model2<span class="fl">.8</span>)[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span><span class="dv">4</span> <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb69-4" data-line-number="4"><span class="st">  </span><span class="kw">fixef</span>(model2<span class="fl">.8</span>)[<span class="dv">4</span>] <span class="op">*</span><span class="st"> </span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb69-5" data-line-number="5"><span class="st">  </span><span class="kw">fixef</span>(model2<span class="fl">.8</span>)[<span class="dv">5</span>] <span class="op">*</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb69-6" data-line-number="6"><span class="st">  </span><span class="kw">fixef</span>(model2<span class="fl">.8</span>)[<span class="dv">6</span>] <span class="op">*</span><span class="st"> </span><span class="dv">30</span></a></code></pre></div>
<pre><code>## [1] 4.791801</code></pre>
<p>Here’s the same deal for a man of the same profile, but with one point higher on <code>negemot</code>.</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb71-1" data-line-number="1"><span class="kw">fixef</span>(model2<span class="fl">.8</span>)[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb71-2" data-line-number="2"><span class="st">  </span><span class="kw">fixef</span>(model2<span class="fl">.8</span>)[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span><span class="dv">4</span> <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb71-3" data-line-number="3"><span class="st">  </span><span class="kw">fixef</span>(model2<span class="fl">.8</span>)[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span><span class="dv">4</span> <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb71-4" data-line-number="4"><span class="st">  </span><span class="kw">fixef</span>(model2<span class="fl">.8</span>)[<span class="dv">4</span>] <span class="op">*</span><span class="st"> </span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb71-5" data-line-number="5"><span class="st">  </span><span class="kw">fixef</span>(model2<span class="fl">.8</span>)[<span class="dv">5</span>] <span class="op">*</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb71-6" data-line-number="6"><span class="st">  </span><span class="kw">fixef</span>(model2<span class="fl">.8</span>)[<span class="dv">6</span>] <span class="op">*</span><span class="st"> </span><span class="dv">30</span></a></code></pre></div>
<pre><code>## [1] 5.232573</code></pre>
<p>If you want a full expression of the model uncertaintly in terms of the shape of the posterior distribution and the 95% intervals, you’ll probably just want to use <code>posterior_samples()</code> and do a little data processing.</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb73-1" data-line-number="1">post &lt;-<span class="st"> </span><span class="kw">posterior_samples</span>(model2<span class="fl">.8</span>)</a>
<a class="sourceLine" id="cb73-2" data-line-number="2"></a>
<a class="sourceLine" id="cb73-3" data-line-number="3">post &lt;-</a>
<a class="sourceLine" id="cb73-4" data-line-number="4"><span class="st">  </span>post <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb73-5" data-line-number="5"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">our_posterior =</span> b_Intercept <span class="op">+</span><span class="st"> </span>b_negemot <span class="op">*</span><span class="st"> </span><span class="dv">4</span> <span class="op">+</span><span class="st"> </span>b_posemot <span class="op">*</span><span class="st"> </span><span class="dv">4</span> <span class="op">+</span><span class="st"> </span>b_ideology <span class="op">*</span><span class="st"> </span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>b_sex <span class="op">*</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>b_age <span class="op">*</span><span class="st"> </span><span class="dv">30</span>)</a>
<a class="sourceLine" id="cb73-6" data-line-number="6"></a>
<a class="sourceLine" id="cb73-7" data-line-number="7"><span class="co"># this intermediary step will make it easier to specify the break points and their labels for the x-axis  </span></a>
<a class="sourceLine" id="cb73-8" data-line-number="8">post_summary &lt;-</a>
<a class="sourceLine" id="cb73-9" data-line-number="9"><span class="st">  </span><span class="kw">quantile</span>(post<span class="op">$</span>our_posterior, <span class="dt">probs =</span> <span class="kw">c</span>(.<span class="dv">025</span>, <span class="fl">.5</span>, <span class="fl">.975</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb73-10" data-line-number="10"><span class="st">  </span><span class="kw">as_tibble</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb73-11" data-line-number="11"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">labels =</span> value <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb73-12" data-line-number="12"><span class="st">           </span><span class="kw">round</span>(<span class="dt">digits =</span> <span class="dv">3</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb73-13" data-line-number="13"><span class="st">           </span><span class="kw">as.character</span>())</a>
<a class="sourceLine" id="cb73-14" data-line-number="14"></a>
<a class="sourceLine" id="cb73-15" data-line-number="15"><span class="co"># plot!</span></a>
<a class="sourceLine" id="cb73-16" data-line-number="16"><span class="kw">ggplot</span>(<span class="dt">data =</span> post,</a>
<a class="sourceLine" id="cb73-17" data-line-number="17">       <span class="kw">aes</span>(<span class="dt">x =</span> our_posterior)) <span class="op">+</span></a>
<a class="sourceLine" id="cb73-18" data-line-number="18"><span class="st">  </span><span class="kw">geom_density</span>(<span class="dt">fill =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb73-19" data-line-number="19"><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> post_summary<span class="op">$</span>value,</a>
<a class="sourceLine" id="cb73-20" data-line-number="20">             <span class="dt">size =</span> <span class="kw">c</span>(.<span class="dv">5</span>, <span class="fl">.75</span>, <span class="fl">.5</span>), <span class="dt">linetype =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>), <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb73-21" data-line-number="21"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb73-22" data-line-number="22">                     <span class="dt">breaks =</span> post_summary<span class="op">$</span>value,</a>
<a class="sourceLine" id="cb73-23" data-line-number="23">                     <span class="dt">labels =</span> post_summary<span class="op">$</span>labels) <span class="op">+</span></a>
<a class="sourceLine" id="cb73-24" data-line-number="24"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb73-25" data-line-number="25"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">subtitle =</span> <span class="st">&quot;The expected govact score for a 30-year-old man for</span><span class="ch">\n</span><span class="st">whom negemot and posemot both equal 4 and ideology</span><span class="ch">\n</span><span class="st">equals 2. The solid and dashed white vertical lines are the</span><span class="ch">\n</span><span class="st">posterior median and 95% intervals, respectively.&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb73-26" data-line-number="26"><span class="st">  </span><span class="kw">theme_bw</span>()</a></code></pre></div>
<p><img src="02_files/figure-html/unnamed-chunk-44-1.png" width="384" /></p>
<p>In the text, Hayes showed that individuals based on these two profiles would be expected to differ by 0.441 (i.e., <span class="math inline">\(5.244 - 4.803 = 0.441\)</span>). That’s fine if you’re only working with OLS point estimates. But a proper Bayesian approach would express the difference in terms of an entire poster distribution, or at least a point estimate accompanied by some sort of intervals. Here we’ll just work with the posterior to create a difference distribution. You could do that with a little deft <code>posterior_samples()</code> wrangling. Here we’ll employ <code>fitted()</code>.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb74-1" data-line-number="1">nd &lt;-</a>
<a class="sourceLine" id="cb74-2" data-line-number="2"><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">negemot  =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">4</span>),</a>
<a class="sourceLine" id="cb74-3" data-line-number="3">         <span class="dt">posemot  =</span> <span class="dv">4</span>,</a>
<a class="sourceLine" id="cb74-4" data-line-number="4">         <span class="dt">ideology =</span> <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb74-5" data-line-number="5">         <span class="dt">sex      =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb74-6" data-line-number="6">         <span class="dt">age      =</span> <span class="dv">30</span>)</a>
<a class="sourceLine" id="cb74-7" data-line-number="7"></a>
<a class="sourceLine" id="cb74-8" data-line-number="8"><span class="kw">fitted</span>(model2<span class="fl">.8</span>, </a>
<a class="sourceLine" id="cb74-9" data-line-number="9">       <span class="dt">newdata =</span> nd,</a>
<a class="sourceLine" id="cb74-10" data-line-number="10">       <span class="dt">summary =</span> F) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb74-11" data-line-number="11"><span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb74-12" data-line-number="12"><span class="st">  </span><span class="kw">set_names</span>(<span class="kw">str_c</span>(<span class="st">&quot;condition_&quot;</span>, letters[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>])) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb74-13" data-line-number="13"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">difference =</span> condition_b <span class="op">-</span><span class="st"> </span>condition_a) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb74-14" data-line-number="14"><span class="st">  </span></a>
<a class="sourceLine" id="cb74-15" data-line-number="15"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> difference)) <span class="op">+</span></a>
<a class="sourceLine" id="cb74-16" data-line-number="16"><span class="st">  </span><span class="kw">geom_density</span>(<span class="dt">fill =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;transparent&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb74-17" data-line-number="17"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb74-18" data-line-number="18"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;The posterior density for the difference between</span><span class="ch">\n</span><span class="st">the two conditions.&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb74-19" data-line-number="19"><span class="st">  </span><span class="kw">theme_bw</span>()</a></code></pre></div>
<p><img src="02_files/figure-html/unnamed-chunk-45-1.png" width="384" /></p>
<div id="the-standardized-regression-model.-1" class="section level3">
<h3><span class="header-section-number">2.4.1</span> The standardized regression model.</h3>
<p>As <strong>brms</strong> doesn’t automatically give us the standardized coefficients the way OLS output often does, we’ll have to be proactive. One solution is just to standardized the data themselves and then re-fit the model with those standardized variables. That leads us to the issue of how one standardized variables to begin with. Recall that standardizing entails subtracting the mean of a variable from that variable and then dividing that value by the standard deviation. We don’t want to do that by hand. So one handy way is to make a custom function to do that work for us.</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb75-1" data-line-number="1">sandardize &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb75-2" data-line-number="2">  (x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x)) <span class="op">/</span><span class="st"> </span><span class="kw">sd</span>(x)</a>
<a class="sourceLine" id="cb75-3" data-line-number="3">}</a></code></pre></div>
<p>Go <a href="http://r4ds.had.co.nz/functions.html">here</a> to learn more about making custom functions in <strong>R</strong>.</p>
<p>Here we’ll employ our custom <code>standardize()</code> function to make standardized versions of our variables.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb76-1" data-line-number="1">glbwarm &lt;-</a>
<a class="sourceLine" id="cb76-2" data-line-number="2"><span class="st">  </span>glbwarm <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb76-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">posemot_z  =</span> <span class="kw">sandardize</span>(posemot), </a>
<a class="sourceLine" id="cb76-4" data-line-number="4">         <span class="dt">negemot_z  =</span> <span class="kw">sandardize</span>(negemot), </a>
<a class="sourceLine" id="cb76-5" data-line-number="5">         <span class="dt">ideology_z =</span> <span class="kw">sandardize</span>(ideology),</a>
<a class="sourceLine" id="cb76-6" data-line-number="6">         <span class="dt">sex_z      =</span> <span class="kw">sandardize</span>(sex),</a>
<a class="sourceLine" id="cb76-7" data-line-number="7">         <span class="dt">age_z      =</span> <span class="kw">sandardize</span>(age))</a></code></pre></div>
<p>Now we’ve got us our standardized variables, let’s fit a standardized model.</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb77-1" data-line-number="1">model2<span class="fl">.9</span> &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb77-2" data-line-number="2"><span class="st">  </span><span class="kw">brm</span>(<span class="dt">data =</span> glbwarm, </a>
<a class="sourceLine" id="cb77-3" data-line-number="3">      <span class="dt">family =</span> gaussian,</a>
<a class="sourceLine" id="cb77-4" data-line-number="4">      govact_z <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>negemot_z <span class="op">+</span><span class="st"> </span>posemot_z <span class="op">+</span><span class="st"> </span>ideology_z <span class="op">+</span><span class="st"> </span>sex_z <span class="op">+</span><span class="st"> </span>age_z,</a>
<a class="sourceLine" id="cb77-5" data-line-number="5">      <span class="dt">cores =</span> <span class="dv">4</span>)</a></code></pre></div>
<p>Here are the newly standardized coefficient summaries, minus the <code>Intercept</code>.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb78-1" data-line-number="1"><span class="kw">fixef</span>(model2<span class="fl">.9</span>)[<span class="op">-</span><span class="dv">1</span>, ] <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">round</span>(<span class="dv">3</span>)</a></code></pre></div>
<pre><code>##            Estimate Est.Error   Q2.5  Q97.5
## negemot_z     0.495     0.030  0.436  0.554
## posemot_z    -0.027     0.028 -0.082  0.028
## ideology_z   -0.242     0.030 -0.300 -0.183
## sex_z        -0.004     0.028 -0.058  0.052
## age_z        -0.015     0.029 -0.072  0.041</code></pre>
<p>Our coefficients match up nicely with those on page 52 in the text. Just as with Hayes’s OLS estimates, we should not attempt to interpret the standardized <code>sex_z</code> coefficient from our Bayesian model.</p>
<p>Here’s how we’d fit a <em>partially</em>-standardized model–a model in which all variables except for <code>sex</code> are standardized.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb80-1" data-line-number="1">model2<span class="fl">.10</span> &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb80-2" data-line-number="2"><span class="st">  </span><span class="kw">update</span>(model2<span class="fl">.9</span>,</a>
<a class="sourceLine" id="cb80-3" data-line-number="3">         <span class="dt">newdata =</span> glbwarm,</a>
<a class="sourceLine" id="cb80-4" data-line-number="4">         <span class="dt">formula =</span> govact_z <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>negemot_z <span class="op">+</span><span class="st"> </span>posemot_z <span class="op">+</span><span class="st"> </span>ideology_z <span class="op">+</span><span class="st"> </span>sex <span class="op">+</span><span class="st"> </span>age_z,</a>
<a class="sourceLine" id="cb80-5" data-line-number="5">         <span class="dt">cores =</span> <span class="dv">4</span>)</a></code></pre></div>
<p>Notice our use of the <code>update()</code> function. If you want to hastily fit a <strong>brms</strong> model of the same basic form of a prior model, you can just update some of the parameters of that original fit. In this case, all we did was swap out one of the predictors. To accommodate that change, we used the <code>newdata</code> argument so the model had access to the new variable and then we fed in the new formula.</p>
<p>Anyway, here are the coefficient summaries, including the <code>Intercept</code>, for the partially-standardized model.</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb81-1" data-line-number="1"><span class="kw">fixef</span>(model2<span class="fl">.10</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">round</span>(<span class="dt">digits =</span> <span class="dv">3</span>)</a></code></pre></div>
<pre><code>##            Estimate Est.Error   Q2.5  Q97.5
## Intercept     0.003     0.039 -0.074  0.078
## negemot_z     0.495     0.030  0.437  0.554
## posemot_z    -0.027     0.028 -0.081  0.027
## ideology_z   -0.242     0.030 -0.303 -0.183
## sex          -0.008     0.055 -0.116  0.099
## age_z        -0.016     0.028 -0.071  0.041</code></pre>
<p>As Hayes wrote, now <code>sex</code> = -0.008 has a sensible interpretation. “We can say that men and women differ by [-0.008] standard deviations in their support for government action when all other variables in the model are held constant (p. 53).”</p>
<p>On page 54, Hayes gave us the equation to transform unstandardized coefficients to standardized ones:</p>
<p><span class="math display">\[
\tilde b_i = b_i \left ( \frac{SD_{X_{i}}}{SD_{Y}} \right )
\]</span></p>
<p>Let’s give it a whirl with <code>negemot</code>.</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb83-1" data-line-number="1"><span class="co"># here&#39;s the coefficient for `negemot` from the standardized model, `model2.9`</span></a>
<a class="sourceLine" id="cb83-2" data-line-number="2"><span class="kw">fixef</span>(model2<span class="fl">.9</span>)[<span class="st">&quot;negemot_z&quot;</span>, <span class="st">&quot;Estimate&quot;</span>]</a></code></pre></div>
<pre><code>## [1] 0.4953418</code></pre>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb85-1" data-line-number="1"><span class="co"># here&#39;s the coefficient for `negemot` from the unstandardized model, `model2.8`</span></a>
<a class="sourceLine" id="cb85-2" data-line-number="2"><span class="kw">fixef</span>(model2<span class="fl">.8</span>)[<span class="st">&quot;negemot&quot;</span>, <span class="st">&quot;Estimate&quot;</span>]</a></code></pre></div>
<pre><code>## [1] 0.4407717</code></pre>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb87-1" data-line-number="1"><span class="co"># and here we use Hayes&#39; formula to standardize the unstandardized coefficient</span></a>
<a class="sourceLine" id="cb87-2" data-line-number="2"><span class="kw">fixef</span>(model2<span class="fl">.8</span>)[<span class="st">&quot;negemot&quot;</span>, <span class="st">&quot;Estimate&quot;</span>] <span class="op">*</span><span class="st"> </span>(<span class="kw">sd</span>(glbwarm<span class="op">$</span>negemot) <span class="op">/</span><span class="st"> </span><span class="kw">sd</span>(glbwarm<span class="op">$</span>govact))</a></code></pre></div>
<pre><code>## [1] 0.4952009</code></pre>
<p>Looks like we got it within rounding error–pretty good! However, that was just the posterior mean, the Bayesian point estimate. If we want to more fully express the uncertainty around the mean–and we do–, we’ll need to work with the posterior draws.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb89-1" data-line-number="1"><span class="co"># the posterior draws from the unstandardized model</span></a>
<a class="sourceLine" id="cb89-2" data-line-number="2"><span class="kw">posterior_samples</span>(model2<span class="fl">.8</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb89-3" data-line-number="3"><span class="st">  </span><span class="co"># using Hayes&#39; formula to standardize `b_negemot`</span></a>
<a class="sourceLine" id="cb89-4" data-line-number="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="st">`</span><span class="dt">hand-made b_negemot_z</span><span class="st">`</span> =<span class="st"> </span>b_negemot <span class="op">*</span><span class="st"> </span>(<span class="kw">sd</span>(glbwarm<span class="op">$</span>negemot) <span class="op">/</span><span class="st"> </span><span class="kw">sd</span>(glbwarm<span class="op">$</span>govact))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb89-5" data-line-number="5"><span class="st">  </span><span class="co"># tacking on the `b_negemot_z` column from the standardized `model2.9` models posterior draws</span></a>
<a class="sourceLine" id="cb89-6" data-line-number="6"><span class="st">  </span><span class="kw">bind_cols</span>(<span class="kw">posterior_samples</span>(model2<span class="fl">.9</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb89-7" data-line-number="7"><span class="st">              </span><span class="kw">select</span>(b_negemot_z)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb89-8" data-line-number="8"><span class="st">  </span><span class="co"># converting the data to the long format and grouping by `name`</span></a>
<a class="sourceLine" id="cb89-9" data-line-number="9"><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="kw">c</span>(<span class="st">`</span><span class="dt">hand-made b_negemot_z</span><span class="st">`</span>, b_negemot_z)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb89-10" data-line-number="10"><span class="st">  </span><span class="kw">group_by</span>(name) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb89-11" data-line-number="11"><span class="st">  </span><span class="co"># here we summarize the results</span></a>
<a class="sourceLine" id="cb89-12" data-line-number="12"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(value),</a>
<a class="sourceLine" id="cb89-13" data-line-number="13">            <span class="dt">sd =</span> <span class="kw">sd</span>(value),</a>
<a class="sourceLine" id="cb89-14" data-line-number="14">            <span class="dt">ll =</span> <span class="kw">quantile</span>(value, <span class="dt">probs =</span> <span class="fl">.025</span>),</a>
<a class="sourceLine" id="cb89-15" data-line-number="15">            <span class="dt">ul =</span> <span class="kw">quantile</span>(value, <span class="dt">probs =</span> <span class="fl">.975</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb89-16" data-line-number="16"><span class="st">  </span><span class="kw">mutate_if</span>(is.double, round, <span class="dt">digits =</span> <span class="dv">3</span>)</a></code></pre></div>
<pre><code>## # A tibble: 2 x 5
##   name                   mean    sd    ll    ul
##   &lt;chr&gt;                 &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 b_negemot_z           0.495 0.03  0.436 0.554
## 2 hand-made b_negemot_z 0.495 0.029 0.437 0.552</code></pre>
<p>Our summary confirms that we can apply Hayes’s formula to a <code>posterior_samples()</code> column in order to get fuller summary statistics for a hand-converted standardized coefficient. This would be in full compliance with, say, APA recommendations to include 95% intervals with all effect sizes–the standardized regression coefficient being the effect size, here.</p>
</div>
</div>
<div id="measures-of-model-fit" class="section level2">
<h2><span class="header-section-number">2.5</span> Measures of model fit</h2>
<p>In the Bayesian world, we don’t tend to appeal to the <span class="math inline">\(SS_{residual}\)</span>, the <span class="math inline">\(MS_{residual}\)</span>, or the standard error of estimate. We do sometimes, however, appeal to the <span class="math inline">\(R^2\)</span>. I’m not going to go into the technical details here, but you should be aware that the Bayesian <span class="math inline">\(R^2\)</span> is not calculated the same as the OLS <span class="math inline">\(R^2\)</span>. If you want to dive in, check out the paper by <a href="https://www.tandfonline.com/doi/abs/10.1080/00031305.2018.1549100?journalCode=utas20">Gelman, Goodrich, Gabry, and Vehtari</a>. Here’s how to get it with <strong>brms</strong>.</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb91-1" data-line-number="1"><span class="kw">bayes_R2</span>(model2<span class="fl">.8</span>, <span class="dt">summary =</span> T) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">round</span>(<span class="dt">digits =</span> <span class="dv">3</span>)</a></code></pre></div>
<pre><code>##    Estimate Est.Error  Q2.5 Q97.5
## R2    0.388     0.021 0.347 0.427</code></pre>
<p>It even comes with 95% intervals, which will make the editors at APA journals happy. If you want to go beyond summary statistics and take a look at the full posterior, just set <code>summary = F</code> and data wrangle and plot as usual.</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb93-1" data-line-number="1"><span class="kw">bayes_R2</span>(model2<span class="fl">.8</span>, <span class="dt">summary =</span> F) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb93-2" data-line-number="2"><span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb93-3" data-line-number="3"><span class="st">  </span></a>
<a class="sourceLine" id="cb93-4" data-line-number="4"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> R2)) <span class="op">+</span></a>
<a class="sourceLine" id="cb93-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_density</span>(<span class="dt">fill =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;transparent&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb93-6" data-line-number="6"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb93-7" data-line-number="7"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Behold: The Bayesian &quot;</span>, <span class="kw">italic</span>(<span class="st">&quot;R&quot;</span>)<span class="op">^</span>{<span class="dv">2</span>}, <span class="st">&quot; distribution for model 2.8&quot;</span>)),</a>
<a class="sourceLine" id="cb93-8" data-line-number="8">       <span class="dt">x     =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb93-9" data-line-number="9"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb93-10" data-line-number="10"><span class="st">  </span><span class="kw">theme_bw</span>()</a></code></pre></div>
<p><img src="02_files/figure-html/unnamed-chunk-55-1.png" width="576" /></p>
<p>Another way we examine model fit is with graphical posterior predictive checks. Posterior predictive checking is a very general approach, which you might learn more about <a href="http://www.stat.columbia.edu/~gelman/research/published/bayes-vis.pdf">here</a> or with a few keyword searches in on <a href="http://andrewgelman.com">Gelman’s blog</a>. One basic way is to use the model in order to simulate data and then compare those data with the original data–the basic idea being that good fitting models should produce data similar to the original data.</p>
<p>Recall how we’ve used <code>fitted()</code> to make regression lines and expected values? We’ll, now we’ll use <code>predict()</code> to simulate data based on our models.</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb94-1" data-line-number="1"><span class="kw">predict</span>(model2<span class="fl">.8</span>,</a>
<a class="sourceLine" id="cb94-2" data-line-number="2">        <span class="dt">summary =</span> F,</a>
<a class="sourceLine" id="cb94-3" data-line-number="3">        <span class="dt">nsamples =</span> <span class="dv">3</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb94-4" data-line-number="4"><span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb94-5" data-line-number="5"><span class="st">  </span><span class="kw">set_names</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(glbwarm)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb94-6" data-line-number="6"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">simulation =</span> <span class="kw">str_c</span>(<span class="st">&quot;simulation: &quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="kw">n</span>())) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb94-7" data-line-number="7"><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="op">-</span>simulation,</a>
<a class="sourceLine" id="cb94-8" data-line-number="8">               <span class="dt">names_to =</span> <span class="st">&quot;row&quot;</span>,</a>
<a class="sourceLine" id="cb94-9" data-line-number="9">               <span class="dt">values_to =</span> <span class="st">&quot;govact&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb94-10" data-line-number="10"><span class="st">  </span><span class="kw">bind_cols</span>(</a>
<a class="sourceLine" id="cb94-11" data-line-number="11">    <span class="kw">bind_rows</span>(</a>
<a class="sourceLine" id="cb94-12" data-line-number="12">      glbwarm <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="op">-</span>govact),</a>
<a class="sourceLine" id="cb94-13" data-line-number="13">      glbwarm <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="op">-</span>govact),</a>
<a class="sourceLine" id="cb94-14" data-line-number="14">      glbwarm <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="op">-</span>govact))</a>
<a class="sourceLine" id="cb94-15" data-line-number="15">    ) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb94-16" data-line-number="16"><span class="st">  </span></a>
<a class="sourceLine" id="cb94-17" data-line-number="17"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> negemot, <span class="dt">y =</span> govact)) <span class="op">+</span></a>
<a class="sourceLine" id="cb94-18" data-line-number="18"><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">height =</span> <span class="fl">.05</span>, <span class="dt">width =</span> <span class="fl">.05</span>, </a>
<a class="sourceLine" id="cb94-19" data-line-number="19">              <span class="dt">alpha =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>, <span class="dt">size =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb94-20" data-line-number="20"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">9</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb94-21" data-line-number="21"><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb94-22" data-line-number="22"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>simulation, <span class="dt">ncol =</span> <span class="dv">3</span>)</a></code></pre></div>
<p><img src="02_files/figure-html/unnamed-chunk-56-1.png" width="960" /></p>
<p>The question is, do these simulated data sets look like the original data? Let’s see.</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb95-1" data-line-number="1">glbwarm <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb95-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> negemot, <span class="dt">y =</span> govact)) <span class="op">+</span></a>
<a class="sourceLine" id="cb95-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">height =</span> <span class="fl">.05</span>, <span class="dt">width =</span> <span class="fl">.05</span>, </a>
<a class="sourceLine" id="cb95-4" data-line-number="4">              <span class="dt">alpha =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>, <span class="dt">size =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb95-5" data-line-number="5"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">9</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb95-6" data-line-number="6"><span class="st">  </span><span class="kw">theme_bw</span>()</a></code></pre></div>
<p><img src="02_files/figure-html/unnamed-chunk-57-1.png" width="321.6" /></p>
<p>Overall, the simulations aren’t bad. But in all three <code>govact</code> tends to veer above 7.5, which is where the original data appear to be bounded. But otherwise the overall shape is pretty close, at least with respect to <code>negemot</code>.</p>
<p>There’s nothing special about three simulations. Three is just more than one and gives you a sense of the variance across simulations. Also, we only examined the model fit with respect to <code>negemot</code>. Since there are other variables in the model, we might also assess the model based on them.</p>
<p>Another method is with the <code>brms::pp_check()</code> function, which allows users to access a variety of convenience functions from the <a href="https://github.com/stan-dev/bayesplot">bayesplot package</a>. Here we’ll use the default settings and just tack on <code>theme_bw()</code> for aesthetics.</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb96-1" data-line-number="1"><span class="kw">pp_check</span>(model2<span class="fl">.8</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb96-2" data-line-number="2"><span class="st">  </span><span class="kw">theme_bw</span>()</a></code></pre></div>
<p><img src="02_files/figure-html/unnamed-chunk-58-1.png" width="576" /></p>
<p>What we did was simulate 10 data sets worth of <code>govact</code> values, plot their densities (i.e., the thin blue lines) and compare them with the density of the original <code>govact</code> values. What we want is for the thin blue lines to largely align with the thick blue line. Though not perfect, the simulations from our <code>model2.8</code> did a pretty okay job of reproducing the original <code>govact</code> distribution. For more ideas on this method, see the <strong>brms</strong> <a href="https://cran.r-project.org/web/packages/brms/brms.pdf">reference manual</a> and <a href="https://cran.r-project.org/web/packages/bayesplot/vignettes/graphical-ppcs.html">this vignette</a> for the <a href="https://mc-stan.org/bayesplot/"><strong>bayesplot</strong> package</a>.</p>
</div>
<div id="statistical-inference" class="section level2">
<h2><span class="header-section-number">2.6</span> Statistical inference</h2>
<p>Here’s a <strong>tidyverse</strong> way to do Hayes’ simulation from page 57. We’re just using OLS regression with the <code>lm()</code> function. You could do this with Bayesian HMC estimation, but man would it take a while. For our first step, we’ll define two custom functions.</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb97-1" data-line-number="1"><span class="co"># this first one will use the `sample_n()` function to randomly sample from `glbwarm`</span></a>
<a class="sourceLine" id="cb97-2" data-line-number="2">make_sample &lt;-<span class="st"> </span><span class="cf">function</span>(i) {</a>
<a class="sourceLine" id="cb97-3" data-line-number="3">  <span class="kw">set.seed</span>(i)</a>
<a class="sourceLine" id="cb97-4" data-line-number="4">  <span class="kw">sample_n</span>(glbwarm, <span class="dv">50</span>, <span class="dt">replace =</span> F)</a>
<a class="sourceLine" id="cb97-5" data-line-number="5">}</a>
<a class="sourceLine" id="cb97-6" data-line-number="6"></a>
<a class="sourceLine" id="cb97-7" data-line-number="7"><span class="co"># this second function will fit our model, the same one from `model2.8`, to each of our subsamples</span></a>
<a class="sourceLine" id="cb97-8" data-line-number="8">glbwarm_model &lt;-<span class="st"> </span><span class="cf">function</span>(df) {</a>
<a class="sourceLine" id="cb97-9" data-line-number="9">  <span class="kw">lm</span>(govact <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>negemot <span class="op">+</span><span class="st"> </span>posemot <span class="op">+</span><span class="st"> </span>ideology <span class="op">+</span><span class="st"> </span>sex <span class="op">+</span><span class="st"> </span>age, <span class="dt">data =</span> df)</a>
<a class="sourceLine" id="cb97-10" data-line-number="10">}</a></code></pre></div>
<p>Now we’ll run the simulation, wrangle the output, and plot in one fell swoop.</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb98-1" data-line-number="1"><span class="co"># we need an iteration index, which will double as the values we set our seed with in our `make_sample()` function</span></a>
<a class="sourceLine" id="cb98-2" data-line-number="2"><span class="kw">tibble</span>(<span class="dt">iter =</span> <span class="dv">1</span><span class="op">:</span><span class="fl">1e4</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb98-3" data-line-number="3"><span class="st">  </span><span class="kw">group_by</span>(iter) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb98-4" data-line-number="4"><span class="st">  </span><span class="co"># inserting our subsamples</span></a>
<a class="sourceLine" id="cb98-5" data-line-number="5"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sample =</span> <span class="kw">map</span>(iter, make_sample)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb98-6" data-line-number="6"><span class="st">  </span><span class="co"># fitting our models</span></a>
<a class="sourceLine" id="cb98-7" data-line-number="7"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">model =</span> <span class="kw">map</span>(sample, glbwarm_model)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb98-8" data-line-number="8"><span class="st">  </span><span class="co"># taking those model results and tidying them with the broom package</span></a>
<a class="sourceLine" id="cb98-9" data-line-number="9"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">broom =</span> <span class="kw">map</span>(model, broom<span class="op">::</span>tidy)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb98-10" data-line-number="10"><span class="st">  </span><span class="co"># unnesting allows us to access our model results</span></a>
<a class="sourceLine" id="cb98-11" data-line-number="11"><span class="st">  </span><span class="kw">unnest</span>(broom) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb98-12" data-line-number="12"><span class="st">  </span><span class="co"># we&#39;re only going to focus on the estimates for `negemot`</span></a>
<a class="sourceLine" id="cb98-13" data-line-number="13"><span class="st">  </span><span class="kw">filter</span>(term <span class="op">==</span><span class="st"> &quot;negemot&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb98-14" data-line-number="14"><span class="st">  </span></a>
<a class="sourceLine" id="cb98-15" data-line-number="15"><span class="st">  </span><span class="co"># here it is, Figure 2.7</span></a>
<a class="sourceLine" id="cb98-16" data-line-number="16"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> estimate)) <span class="op">+</span></a>
<a class="sourceLine" id="cb98-17" data-line-number="17"><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="fl">.025</span>, <span class="dt">boundary =</span> <span class="dv">0</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb98-18" data-line-number="18"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Unstandardized regression coefficient for negemot&quot;</span>,</a>
<a class="sourceLine" id="cb98-19" data-line-number="19">       <span class="dt">y =</span> <span class="st">&quot;Frequency in 1e4 samples of size 50&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb98-20" data-line-number="20"><span class="st">  </span><span class="kw">theme_bw</span>()</a></code></pre></div>
<p><img src="02_files/figure-html/sim-1.png" width="576" /></p>
<p>To learn more about this approach to simulations, see <a href="http://r4ds.had.co.nz/many-models.html#nested-data">this section of <em>R4DS</em></a>.</p>
<div id="testing-a-null-hypothesis." class="section level3">
<h3><span class="header-section-number">2.6.1</span> Testing a null hypothesis.</h3>
<p>As Bayesians, we don’t need to wed ourselves to the null hypothesis. We’re not interested in the probability of the data given the null hypothesis. Bayes’ rule,</p>
<p><span class="math display">\[p(\theta | D) = \frac{p(D | \theta) p(\theta)}{p(D)},\]</span></p>
<p>gives us the probability of the model parameters, given the data. Though I acknowledge <a href="http://daniellakens.blogspot.com/2017/11/the-statisticians-fallacy.html">different researchers might set out to ask different things of their data</a>, I propose we’re generally more interested in determining the most probable parameter values than we are the probabilities tested within the NHST paradigm.</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb99-1" data-line-number="1"><span class="kw">posterior_samples</span>(model2<span class="fl">.8</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb99-2" data-line-number="2"><span class="st">  </span></a>
<a class="sourceLine" id="cb99-3" data-line-number="3"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> b_negemot)) <span class="op">+</span></a>
<a class="sourceLine" id="cb99-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_density</span>(<span class="dt">fill =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;transparent&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb99-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="kw">posterior_interval</span>(model2<span class="fl">.8</span>)[<span class="st">&quot;b_negemot&quot;</span>, ],</a>
<a class="sourceLine" id="cb99-6" data-line-number="6">             <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">linetype =</span> <span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb99-7" data-line-number="7"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">posterior_interval</span>(model2<span class="fl">.8</span>)[<span class="st">&quot;b_negemot&quot;</span>, ] <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.double</span>(),</a>
<a class="sourceLine" id="cb99-8" data-line-number="8">                     <span class="dt">labels =</span> <span class="kw">posterior_interval</span>(model2<span class="fl">.8</span>)[<span class="st">&quot;b_negemot&quot;</span>, ] <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.double</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">round</span>(<span class="dt">digits =</span> <span class="dv">2</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.character</span>()) <span class="op">+</span></a>
<a class="sourceLine" id="cb99-9" data-line-number="9"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb99-10" data-line-number="10"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">subtitle =</span> <span class="st">&quot;The most probable values for our b_negemot parameter are the ones around the peak</span><span class="ch">\n</span><span class="st">of the density. For convenience, the dashed lines denote the 95% credible intervals.</span><span class="ch">\n</span><span class="st">Sure, you could ask yourself, &#39;Is zero within those intervals?&#39; But with such rich output,</span><span class="ch">\n</span><span class="st">that seems like an impoverished question to ask.&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb99-11" data-line-number="11"><span class="st">  </span><span class="kw">theme_bw</span>()</a></code></pre></div>
<p><img src="02_files/figure-html/unnamed-chunk-60-1.png" width="576" /></p>
<p>For more discussion the NHST paradigm and how it compares with variations of Bayesian statistics, check out Kruschke’s text, <a href="https://sites.google.com/site/doingbayesiandataanalysis/"><em>Doing Bayesian Data Analysis</em></a>, particularly chapters 10 through 13. I’m currently working on translating all his code for use with <strong>brms</strong> and the <strong>tidyverse</strong>. You can find that project, <a href="https://github.com/ASKurz/Doing-Bayesian-Data-Analysis-in-brms-and-the-tidyverse">here</a>.</p>
</div>
<div id="interval-estimation." class="section level3">
<h3><span class="header-section-number">2.6.2</span> Interval estimation.</h3>
<p>Within the Bayesian paradigm, we don’t use 95% intervals based on the typical frequentist formula. With the <strong>brms</strong> package, we typically use percentile-based intervals. Take the 95% credible intervals for the <code>negemot</code> coefficient from model <code>model2.8</code>:</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb100-1" data-line-number="1"><span class="kw">posterior_interval</span>(model2<span class="fl">.8</span>)[<span class="st">&quot;b_negemot&quot;</span>, ]</a></code></pre></div>
<pre><code>##      2.5%     97.5% 
## 0.3886650 0.4913098</code></pre>
<p>We can actually get those intervals with the simple use of the base <strong>R</strong> <code>quantile()</code> function.</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb102-1" data-line-number="1"><span class="kw">posterior_samples</span>(model2<span class="fl">.8</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb102-2" data-line-number="2"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">the_2.5_percentile  =</span> <span class="kw">quantile</span>(b_negemot, <span class="dt">probs =</span> <span class="fl">.025</span>),</a>
<a class="sourceLine" id="cb102-3" data-line-number="3">            <span class="dt">the_97.5_percentile =</span> <span class="kw">quantile</span>(b_negemot, <span class="dt">probs =</span> <span class="fl">.975</span>))</a></code></pre></div>
<pre><code>##   the_2.5_percentile the_97.5_percentile
## 1           0.388665           0.4913098</code></pre>
<p>The consequence of this is that our Bayesian credible intervals aren’t necessarily symmetric, which is fine because the posterior distribution for a given parameter isn’t always symmetric. But not all Bayesian intervals are percentile based. John Kruschke, for example, often recommends highest posterior density intervals in <a href="http://www.indiana.edu/~kruschke/DoingBayesianDataAnalysis/">his work</a>. The <strong>brms</strong> package doesn’t have a convenience function for these, but you can compute them with help from the <a href="https://cran.r-project.org/web/packages/HDInterval/index.html">HDInterval package</a>.</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb104-1" data-line-number="1"><span class="kw">library</span>(HDInterval)</a>
<a class="sourceLine" id="cb104-2" data-line-number="2"></a>
<a class="sourceLine" id="cb104-3" data-line-number="3"><span class="kw">hdi</span>(<span class="kw">posterior_samples</span>(model2<span class="fl">.8</span>)[ , <span class="st">&quot;b_negemot&quot;</span>], <span class="dt">credMass =</span> <span class="fl">.95</span>)</a></code></pre></div>
<pre><code>##     lower     upper 
## 0.3877626 0.4903139 
## attr(,&quot;credMass&quot;)
## [1] 0.95</code></pre>
<p>Finally, because Bayesians aren’t bound to the NHST paradigm, we aren’t bound to 95% intervals, either. For example, in both his <a href="http://xcelab.net/rm/statistical-rethinking/">excellent text</a> and as a default in its accompanying <a href="https://github.com/rmcelreath/rethinking"><strong>rethinking</strong> package</a>, <a href="https://twitter.com/rlmcelreath">Richard McElreath</a> often uses 89% intervals. Alternatively, <a href="https://twitter.com/StatModeling">Andrew Gelman</a> has publicly advocated for <a href="http://andrewgelman.com/2016/11/05/why-i-prefer-50-to-95-intervals/">50% intervals</a>. The most important thing is to express the uncertainty in the posterior in a clearly-specified way. If you’d like, say, 80% intervals in your model summary, you can insert a <code>prob</code> argument into either <code>print()</code> or <code>summary()</code>.</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb106-1" data-line-number="1"><span class="kw">print</span>(model2<span class="fl">.8</span>, <span class="dt">prob =</span> <span class="fl">.8</span>)</a></code></pre></div>
<pre><code>##  Family: gaussian 
##   Links: mu = identity; sigma = identity 
## Formula: govact ~ 1 + negemot + posemot + ideology + sex + age 
##    Data: glbwarm (Number of observations: 815) 
## Samples: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
##          total post-warmup samples = 4000
## 
## Population-Level Effects: 
##           Estimate Est.Error l-80% CI u-80% CI Rhat Bulk_ESS Tail_ESS
## Intercept     4.06      0.20     3.79     4.32 1.00     5191     3658
## negemot       0.44      0.03     0.41     0.47 1.00     4980     2981
## posemot      -0.03      0.03    -0.06     0.01 1.00     5830     3143
## ideology     -0.22      0.03    -0.25    -0.18 1.00     4484     3113
## sex          -0.01      0.08    -0.11     0.09 1.00     5623     2719
## age          -0.00      0.00    -0.00     0.00 1.00     5705     3159
## 
## Family Specific Parameters: 
##       Estimate Est.Error l-80% CI u-80% CI Rhat Bulk_ESS Tail_ESS
## sigma     1.07      0.03     1.03     1.10 1.00     6039     2837
## 
## Samples were drawn using sampling(NUTS). For each parameter, Eff.Sample 
## is a crude measure of effective sample size, and Rhat is the potential 
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>Note how two of our columns changed to ‘l-80% CI’ and ‘u-80% CI’.</p>
<p>You can specify custom percentile levels with <code>posterior_summary()</code>:</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb108-1" data-line-number="1"><span class="kw">posterior_summary</span>(model2<span class="fl">.8</span>, <span class="dt">probs =</span> <span class="kw">c</span>(.<span class="dv">9</span>, <span class="fl">.8</span>, <span class="fl">.7</span>, <span class="fl">.6</span>, <span class="fl">.4</span>, <span class="fl">.3</span>, <span class="fl">.2</span>, <span class="fl">.1</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb108-2" data-line-number="2"><span class="st">  </span><span class="kw">round</span>(<span class="dt">digits =</span> <span class="dv">2</span>)</a></code></pre></div>
<pre><code>##             Estimate Est.Error      Q90      Q80      Q70      Q60      Q40      Q30      Q20      Q10
## b_Intercept     4.06      0.20     4.32     4.22     4.16     4.11     4.01     3.95     3.88     3.79
## b_negemot       0.44      0.03     0.47     0.46     0.45     0.45     0.43     0.43     0.42     0.41
## b_posemot      -0.03      0.03     0.01     0.00    -0.01    -0.02    -0.03    -0.04    -0.05    -0.06
## b_ideology     -0.22      0.03    -0.18    -0.19    -0.20    -0.21    -0.22    -0.23    -0.24    -0.25
## b_sex          -0.01      0.08     0.09     0.05     0.03     0.01    -0.03    -0.05    -0.07    -0.11
## b_age           0.00      0.00     0.00     0.00     0.00     0.00     0.00     0.00     0.00     0.00
## sigma           1.07      0.03     1.10     1.09     1.08     1.08     1.06     1.05     1.05     1.03
## lp__        -1215.89      1.93 -1213.76 -1214.28 -1214.69 -1215.12 -1216.01 -1216.59 -1217.38 -1218.51</code></pre>
<p>And of course, you can use multiple interval summaries when you <code>summarize()</code> the output from <code>posterior_samples()</code>. E.g.,</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb110-1" data-line-number="1"><span class="kw">posterior_samples</span>(model2<span class="fl">.8</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb110-2" data-line-number="2"><span class="st">  </span><span class="kw">select</span>(b_Intercept<span class="op">:</span>b_age) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb110-3" data-line-number="3"><span class="st">  </span><span class="kw">gather</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb110-4" data-line-number="4"><span class="st">  </span><span class="kw">group_by</span>(key) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb110-5" data-line-number="5"><span class="st">  </span><span class="kw">summarize</span>(<span class="st">`</span><span class="dt">l-95% CI</span><span class="st">`</span> =<span class="st"> </span><span class="kw">quantile</span>(value, <span class="dt">probs =</span> <span class="fl">.025</span>),</a>
<a class="sourceLine" id="cb110-6" data-line-number="6">            <span class="st">`</span><span class="dt">u-95% CI</span><span class="st">`</span> =<span class="st"> </span><span class="kw">quantile</span>(value, <span class="dt">probs =</span> <span class="fl">.975</span>),</a>
<a class="sourceLine" id="cb110-7" data-line-number="7">            <span class="st">`</span><span class="dt">l-50% CI</span><span class="st">`</span> =<span class="st"> </span><span class="kw">quantile</span>(value, <span class="dt">probs =</span> <span class="fl">.25</span>),</a>
<a class="sourceLine" id="cb110-8" data-line-number="8">            <span class="st">`</span><span class="dt">u-50% CI</span><span class="st">`</span> =<span class="st"> </span><span class="kw">quantile</span>(value, <span class="dt">probs =</span> <span class="fl">.75</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb110-9" data-line-number="9"><span class="st">  </span><span class="kw">mutate_if</span>(is.double, round, <span class="dt">digits =</span> <span class="dv">2</span>)</a></code></pre></div>
<pre><code>## # A tibble: 6 x 5
##   key         `l-95% CI` `u-95% CI` `l-50% CI` `u-50% CI`
##   &lt;chr&gt;            &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;
## 1 b_age            -0.01       0          0          0   
## 2 b_ideology       -0.27      -0.17      -0.24      -0.2 
## 3 b_Intercept       3.68       4.45       3.92       4.19
## 4 b_negemot         0.39       0.49       0.42       0.46
## 5 b_posemot        -0.08       0.03      -0.04      -0.01
## 6 b_sex            -0.16       0.14      -0.06       0.04</code></pre>
<p>Throughout this project, I’m going to be lazy and default to conventional 95% intervals, with occasional appearances of 50% intervals.</p>
</div>
<div id="testing-a-hypothesis-about-a-set-of-antecedent-variables." class="section level3">
<h3><span class="header-section-number">2.6.3</span> Testing a hypothesis about a set of antecedent variables.</h3>
<p>Here we’ll make use of the <code>update()</code> function to hastily fit our reduced model, <code>model5</code>.</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb112-1" data-line-number="1">model2<span class="fl">.11</span> &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb112-2" data-line-number="2"><span class="st">  </span><span class="kw">update</span>(model2<span class="fl">.8</span>,</a>
<a class="sourceLine" id="cb112-3" data-line-number="3">         govact <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>ideology <span class="op">+</span><span class="st"> </span>sex <span class="op">+</span><span class="st"> </span>age,</a>
<a class="sourceLine" id="cb112-4" data-line-number="4">         <span class="dt">cores =</span> <span class="dv">4</span>)</a></code></pre></div>
<p>We can get a look at the <span class="math inline">\(R^2\)</span> summaries for our competing models like this.</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb113-1" data-line-number="1"><span class="kw">bayes_R2</span>(model2<span class="fl">.8</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">round</span>(<span class="dt">digits =</span> <span class="dv">2</span>)</a></code></pre></div>
<pre><code>##    Estimate Est.Error Q2.5 Q97.5
## R2     0.39      0.02 0.35  0.43</code></pre>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb115-1" data-line-number="1"><span class="kw">bayes_R2</span>(model2<span class="fl">.11</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">round</span>(<span class="dt">digits =</span> <span class="dv">2</span>)</a></code></pre></div>
<pre><code>##    Estimate Est.Error Q2.5 Q97.5
## R2     0.18      0.02 0.14  0.22</code></pre>
<p>So far it looks like our fuller model, <code>model2.8</code>, explains more variation in the data. If we wanted to look at their distributions, we’d set <code>summary = F</code> in the <code>bayes_R2()</code> function and convert the results to a data frame or tibble. Here we use <code>bind_cols()</code> to put the <span class="math inline">\(R^2\)</span> results for both in the same tibble.</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb117-1" data-line-number="1">r2 &lt;-</a>
<a class="sourceLine" id="cb117-2" data-line-number="2"><span class="st">  </span><span class="kw">bayes_R2</span>(model2<span class="fl">.8</span>, <span class="dt">summary =</span> F) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb117-3" data-line-number="3"><span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb117-4" data-line-number="4"><span class="st">  </span><span class="kw">set_names</span>(<span class="st">&quot;model2.8&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb117-5" data-line-number="5"><span class="st">  </span><span class="kw">bind_cols</span>(</a>
<a class="sourceLine" id="cb117-6" data-line-number="6">    <span class="kw">bayes_R2</span>(model2<span class="fl">.11</span>, <span class="dt">summary =</span> F) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb117-7" data-line-number="7"><span class="st">      </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb117-8" data-line-number="8"><span class="st">      </span><span class="kw">set_names</span>(<span class="st">&quot;model2.11&quot;</span>)</a>
<a class="sourceLine" id="cb117-9" data-line-number="9">  )</a>
<a class="sourceLine" id="cb117-10" data-line-number="10"></a>
<a class="sourceLine" id="cb117-11" data-line-number="11"><span class="kw">head</span>(r2)</a></code></pre></div>
<pre><code>##    model2.8 model2.11
## 1 0.3510849 0.1446630
## 2 0.3508106 0.1879446
## 3 0.4224058 0.1598793
## 4 0.3762641 0.1677146
## 5 0.4080467 0.1882133
## 6 0.4080467 0.1538636</code></pre>
<p>With our <code>r2</code> tibble in hand, we’re ready to plot.</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb119-1" data-line-number="1">r2 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb119-2" data-line-number="2"><span class="st">  </span><span class="kw">gather</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb119-3" data-line-number="3"><span class="st">  </span></a>
<a class="sourceLine" id="cb119-4" data-line-number="4"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> value, <span class="dt">fill =</span> key)) <span class="op">+</span></a>
<a class="sourceLine" id="cb119-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_density</span>(<span class="dt">color =</span> <span class="st">&quot;transparent&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb119-6" data-line-number="6"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb119-7" data-line-number="7"><span class="st">  </span><span class="kw">xlab</span>(<span class="kw">expression</span>(<span class="kw">paste</span>(<span class="kw">italic</span>(R)<span class="op">^</span><span class="dv">2</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb119-8" data-line-number="8"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb119-9" data-line-number="9"><span class="st">  </span><span class="kw">theme_bw</span>()</a></code></pre></div>
<p><img src="02_files/figure-html/unnamed-chunk-70-1.png" width="576" /></p>
<p>Yep, the <span class="math inline">\(R^2\)</span> distribution for <code>model2.8</code>, the one including the emotion variables, is clearly larger than that for the more parsimonious <code>model2.11</code>. And it’d just take a little more data wrangling to get a formal <span class="math inline">\(R^2\)</span> difference score.</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb120-1" data-line-number="1">r2 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb120-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">difference =</span> model2<span class="fl">.11</span> <span class="op">-</span><span class="st"> </span>model2<span class="fl">.8</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb120-3" data-line-number="3"><span class="st">  </span></a>
<a class="sourceLine" id="cb120-4" data-line-number="4"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> difference)) <span class="op">+</span></a>
<a class="sourceLine" id="cb120-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_density</span>(<span class="dt">fill =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;transparent&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb120-6" data-line-number="6"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb120-7" data-line-number="7"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="dv">-1</span><span class="op">:</span><span class="dv">0</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb120-8" data-line-number="8"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title    =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(Delta, <span class="kw">italic</span>(R)<span class="op">^</span>{<span class="dv">2</span>})),</a>
<a class="sourceLine" id="cb120-9" data-line-number="9">       <span class="dt">subtitle =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;This is the amount the &quot;</span>, <span class="kw">italic</span>(R)<span class="op">^</span>{<span class="dv">2</span>}, <span class="st">&quot; dropped after pruning the emotion variables from the model.&quot;</span>)),</a>
<a class="sourceLine" id="cb120-10" data-line-number="10">       <span class="dt">x =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb120-11" data-line-number="11"><span class="st">  </span><span class="kw">theme_bw</span>()</a></code></pre></div>
<p><img src="02_files/figure-html/unnamed-chunk-71-1.png" width="576" /></p>
<p>The <span class="math inline">\(R^2\)</span> approach is popular within the social sciences. But it has its limitations, the first of which is that it doesn’t correct for model complexity. The second is it’s not applicable to a range of models, such as those that do not use the Gaussian likelihood (e.g., logistic regression) or to multilevel models.</p>
<p>Happily, information criteria offer a more general framework. The AIC is the most popular information criteria among frequentists. Within the Bayesian world, we have the DIC, the WAIC, and the LOO. The DIC is quickly falling out of favor and is not immediately available with the <strong>brms</strong> package. However, we can use the WAIC and the LOO, both of which are computed in <strong>brms</strong> via the <a href="https://github.com/stan-dev/loo"><strong>loo</strong> package</a>.</p>
<p>With <strong>brms</strong>, you can compute the WAIC or LOO values and add them to your model fit object with the <code>add_criterion()</code> function.</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb121-1" data-line-number="1">model2<span class="fl">.8</span>  &lt;-<span class="st"> </span><span class="kw">add_criterion</span>(model2<span class="fl">.8</span>,  <span class="kw">c</span>(<span class="st">&quot;loo&quot;</span>, <span class="st">&quot;waic&quot;</span>))</a>
<a class="sourceLine" id="cb121-2" data-line-number="2">model2<span class="fl">.11</span> &lt;-<span class="st"> </span><span class="kw">add_criterion</span>(model2<span class="fl">.11</span>, <span class="kw">c</span>(<span class="st">&quot;loo&quot;</span>, <span class="st">&quot;waic&quot;</span>))</a></code></pre></div>
<p>Here’s the main loo-summary output for <code>model4</code>.</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb122-1" data-line-number="1">model2<span class="fl">.8</span><span class="op">$</span>loo</a></code></pre></div>
<pre><code>## 
## Computed from 4000 by 815 log-likelihood matrix
## 
##          Estimate   SE
## elpd_loo  -1214.0 22.7
## p_loo         7.8  0.7
## looic      2428.0 45.5
## ------
## Monte Carlo SE of elpd_loo is 0.0.
## 
## All Pareto k estimates are good (k &lt; 0.5).
## See help(&#39;pareto-k-diagnostic&#39;) for details.</code></pre>
<p>You get a wealth of output, more of which can be seen with <code>str(model2.8$loo)</code>. For now, notice the “All pareto k estimates are good (k &lt; 0.5).” Pareto <span class="math inline">\(k\)</span> values <a href="https://cran.r-project.org/web/packages/loo/vignettes/loo2-example.html#plotting-pareto-k-diagnostics">can be used for diagnostics</a>. Each case in the data gets its own <span class="math inline">\(k\)</span> value and we like it when those <span class="math inline">\(k\)</span>s are low. The makers of the <strong>loo</strong> package get worried when those <span class="math inline">\(k\)</span>s exceed 0.7 and as a result you will get a warning message when they do. Happily, we have no such warning messages in this example.</p>
<p>If you want to work with the <span class="math inline">\(k\)</span> values directly, you can extract them and place them into a data frame like so.</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb124-1" data-line-number="1">model2<span class="fl">.8</span><span class="op">$</span>loo<span class="op">$</span>diagnostics <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb124-2" data-line-number="2"><span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb124-3" data-line-number="3"><span class="st">  </span><span class="kw">head</span>()</a></code></pre></div>
<pre><code>##      pareto_k    n_eff
## 1  0.10023379 5260.883
## 2 -0.03742048 4716.082
## 3  0.05058887 5196.898
## 4  0.07108415 2515.394
## 5  0.03036345 4785.764
## 6 -0.01275420 5811.755</code></pre>
<p>The <code>pareto_k</code> values can be used to examine cases that are overly-influential on the model parameters, something akin to a Cook’s <span class="math inline">\(D_i\)</span>. See, for example <a href="https://stackoverflow.com/questions/39578834/linear-model-diagnostics-for-bayesian-models-using-rstan/39595436">this discussion on stackoverflow.com</a> in which several members of the <a href="http://mc-stan.org">Stan team</a> weighed in. The issue is also discussed in <a href="https://arxiv.org/abs/1507.04544">this paper</a> and in <a href="https://www.youtube.com/watch?v=FUROJM3u5HQ&amp;feature=youtu.be&amp;a=">this lecture by Aki Vehtari</a>.</p>
<p>But anyway, we’re getting ahead of ourselves. Back to the LOO.</p>
<p>Like other information criteria, the LOO values aren’t of interest in and of themselves. However, the values of one model’s LOO relative to that of another is of great interest. We generally prefer models with lower information criteria. With <code>compare_ic()</code>, we can compute a formal difference score between multiple loo objects.</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb126-1" data-line-number="1"><span class="kw">loo_compare</span>(model2<span class="fl">.8</span>, model2<span class="fl">.11</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">print</span>(<span class="dt">simplify =</span> F)</a></code></pre></div>
<pre><code>##           elpd_diff se_diff elpd_loo se_elpd_loo p_loo   se_p_loo looic   se_looic
## model2.8      0.0       0.0 -1214.0     22.7         7.8     0.7   2428.0    45.5 
## model2.11  -118.4      15.9 -1332.4     20.6         5.0     0.3   2664.8    41.1</code></pre>
<p>We also get a standard error. Here it looks like <code>model2.8</code> was substantially better, in terms of LOO-values, than <code>model2.11</code>.</p>
<p>For more on the LOO, see the <a href="https://cran.r-project.org/web/packages/loo/loo.pdf"><strong>loo</strong> reference manual</a>, this <a href="https://cran.r-project.org/web/packages/loo/vignettes/loo2-example.html">handy vignette</a>, or the scholarly papers referenced therein. Also, although McElreath doesn’t discuss the LOO, he does cover the topic in general in his <a href="http://xcelab.net/rm/statistical-rethinking/">text</a> and in his <a href="https://www.youtube.com/watch?v=t0pRuy1_190&amp;t=1307s&amp;list=PLDcUM9US4XdM9_N6XUUFrhghGJ4K25bFc&amp;index=9">online lectures on the topic</a>.</p>
</div>
</div>
<div id="multicategorical-antecedent-variables" class="section level2">
<h2><span class="header-section-number">2.7</span> Multicategorical antecedent variables</h2>
<p>“To include a multicategorical antecedent variable representing <span class="math inline">\(g\)</span> groups in a regression model, it must be represented with <span class="math inline">\(g − 1\)</span> variables using one of a variety of different group coding systems”. (p. 66) This isn’t strictly true, but we digress. Hayes went on…</p>
<blockquote>
<p>One popular system for coding groups is <em>indicator coding</em>, also known as <em>dummy coding</em>. With indicator coding, <span class="math inline">\(g − 1\)</span> <em>indicator variables</em> containing either a zero or one represent which of the <span class="math inline">\(g\)</span> groups a case belongs in, and these indicator variables are used as antecedents in a regression model. To construct indicator codes, create <span class="math inline">\(g − 1\)</span> variables <span class="math inline">\(D_i\)</span> for each case set to 1 if the case is in group <span class="math inline">\(i\)</span>, otherwise set <span class="math inline">\(D_i\)</span> to zero. (p. 66, <em>emphasis</em> in the original)</p>
</blockquote>
<p>Before we get to that, we should examine our multicategorical antecedent variable, <code>partyid</code>. It’s coded 1 = Democrat 2 = Independent 3 = Repuclican. You can get a count of the cases within a give <code>partyid</code> like this.</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb128-1" data-line-number="1">glbwarm <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb128-2" data-line-number="2"><span class="st">  </span><span class="kw">count</span>(partyid)</a></code></pre></div>
<pre><code>## # A tibble: 3 x 2
##   partyid     n
##     &lt;dbl&gt; &lt;int&gt;
## 1       1   359
## 2       2   192
## 3       3   264</code></pre>
<p>We can get grouped means for <code>govact</code> like this.</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb130-1" data-line-number="1">glbwarm <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb130-2" data-line-number="2"><span class="st">  </span><span class="kw">group_by</span>(partyid) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb130-3" data-line-number="3"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">mean_support_for_governmental_action =</span> <span class="kw">mean</span>(govact))</a></code></pre></div>
<pre><code>## # A tibble: 3 x 2
##   partyid mean_support_for_governmental_action
##     &lt;dbl&gt;                                &lt;dbl&gt;
## 1       1                                 5.06
## 2       2                                 4.61
## 3       3                                 3.92</code></pre>
<p>We can make dummies with the <code>if_else()</code> function. We’ll just go ahead and do that right within the <code>brm()</code> function.</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb132-1" data-line-number="1">model2<span class="fl">.12</span> &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb132-2" data-line-number="2"><span class="st">  </span><span class="kw">brm</span>(<span class="dt">data =</span> glbwarm <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb132-3" data-line-number="3"><span class="st">        </span><span class="kw">mutate</span>(<span class="dt">Democrat =</span> <span class="kw">if_else</span>(partyid <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>),</a>
<a class="sourceLine" id="cb132-4" data-line-number="4">               <span class="dt">Republican =</span> <span class="kw">if_else</span>(partyid <span class="op">==</span><span class="st"> </span><span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">0</span>)), </a>
<a class="sourceLine" id="cb132-5" data-line-number="5">      <span class="dt">family =</span> gaussian,</a>
<a class="sourceLine" id="cb132-6" data-line-number="6">      govact <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Democrat <span class="op">+</span><span class="st"> </span>Republican,</a>
<a class="sourceLine" id="cb132-7" data-line-number="7">      <span class="dt">chains =</span> <span class="dv">4</span>, <span class="dt">cores =</span> <span class="dv">4</span>)</a></code></pre></div>
<p>Check the results.</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb133-1" data-line-number="1"><span class="kw">fixef</span>(model2<span class="fl">.12</span>)</a></code></pre></div>
<pre><code>##              Estimate Est.Error       Q2.5      Q97.5
## Intercept   4.6060751 0.0879319  4.4375924  4.7817712
## Democrat    0.4591856 0.1109220  0.2426579  0.6762889
## Republican -0.6801175 0.1165303 -0.9097553 -0.4541862</code></pre>
<p>The intercept is the stand-in for Independents and the other two coefficients are difference scores.</p>
<p>The <span class="math inline">\(R^2\)</span> is okay.</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb135-1" data-line-number="1"><span class="kw">bayes_R2</span>(model2<span class="fl">.12</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">round</span>(<span class="dt">digits =</span> <span class="dv">3</span>)</a></code></pre></div>
<pre><code>##    Estimate Est.Error  Q2.5 Q97.5
## R2    0.132     0.021 0.092 0.174</code></pre>
<p>There’s no need to compute an <span class="math inline">\(F\)</span>-test on our <span class="math inline">\(R^2\)</span>. The posterior mean and it’s 95% intervals are well away from zero. But you could use your <code>bayes_R2(model2.12, summary = F)</code> plotting skills from above to more fully inspect the posterior if you’d like.</p>
<p>We could also use information criteria. One method would be to compare the WAIC or LOO value of <code>model2.12</code> with an intercept-only model. First, we’ll need to fit that model.</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb137-1" data-line-number="1">model2<span class="fl">.13</span> &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb137-2" data-line-number="2"><span class="st">  </span><span class="kw">update</span>(model2<span class="fl">.12</span>,</a>
<a class="sourceLine" id="cb137-3" data-line-number="3">         govact <span class="op">~</span><span class="st"> </span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb137-4" data-line-number="4">         <span class="dt">chains =</span> <span class="dv">4</span>, <span class="dt">cores =</span> <span class="dv">4</span>)</a></code></pre></div>
<p>Here we’ll compute the WAIC for each, save the results to their fit objects, and them compare them with <code>loo_compare()</code>.</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb138-1" data-line-number="1">model2<span class="fl">.12</span> &lt;-<span class="st"> </span><span class="kw">add_criterion</span>(model2<span class="fl">.12</span>, <span class="st">&quot;waic&quot;</span>)</a>
<a class="sourceLine" id="cb138-2" data-line-number="2">model2<span class="fl">.13</span> &lt;-<span class="st"> </span><span class="kw">add_criterion</span>(model2<span class="fl">.13</span>, <span class="st">&quot;waic&quot;</span>)</a>
<a class="sourceLine" id="cb138-3" data-line-number="3"></a>
<a class="sourceLine" id="cb138-4" data-line-number="4"><span class="kw">loo_compare</span>(model2<span class="fl">.12</span>, model2<span class="fl">.13</span>, <span class="dt">criterion =</span> <span class="st">&quot;waic&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb138-5" data-line-number="5"><span class="st">  </span><span class="kw">print</span>(<span class="dt">simplify =</span> F)</a></code></pre></div>
<pre><code>##           elpd_diff se_diff elpd_waic se_elpd_waic p_waic  se_p_waic waic    se_waic
## model2.12     0.0       0.0 -1353.5      20.1          4.0     0.2    2707.1    40.1
## model2.13   -55.3      10.4 -1408.9      21.3          2.1     0.1    2817.7    42.7</code></pre>
<p>The WAIC comparison suggests <code>model2.12</code>, the one <em>with</em> the <code>partyid</code> dummies, is an improvement over the simple intercept-only model. Another way to compare the information criteria is with AIC-type weighting. The brms package offers a variety of weighting methods via the <code>model_weights()</code> function.</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb140-1" data-line-number="1">mw &lt;-<span class="st"> </span><span class="kw">model_weights</span>(model2<span class="fl">.12</span>, model2<span class="fl">.13</span>, <span class="dt">weights =</span> <span class="st">&quot;waic&quot;</span>)</a>
<a class="sourceLine" id="cb140-2" data-line-number="2"></a>
<a class="sourceLine" id="cb140-3" data-line-number="3">mw</a></code></pre></div>
<pre><code>##    model2.12    model2.13 
## 1.000000e+00 9.386167e-25</code></pre>
<p>If you’re not a fan of scientific notation, you can put the results in a tibble and look at them on a plot.</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb142-1" data-line-number="1">mw <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb142-2" data-line-number="2"><span class="st">  </span><span class="kw">as.data.frame</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb142-3" data-line-number="3"><span class="st">  </span><span class="kw">rownames_to_column</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb142-4" data-line-number="4"><span class="st">  </span><span class="kw">set_names</span>(<span class="kw">c</span>(<span class="st">&quot;model&quot;</span>, <span class="st">&quot;WAIC weight&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb142-5" data-line-number="5"></a>
<a class="sourceLine" id="cb142-6" data-line-number="6"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="st">`</span><span class="dt">WAIC weight</span><span class="st">`</span>, <span class="dt">y =</span> model)) <span class="op">+</span></a>
<a class="sourceLine" id="cb142-7" data-line-number="7"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb142-8" data-line-number="8"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">subtitle =</span> <span class="st">&quot;The weights should sum to 1. In this case virtually all the weight is placed</span><span class="ch">\n</span><span class="st">in model2.12. Recall, that these are RELATIVE weights. Add another model</span><span class="ch">\n</span><span class="st">fit into the mix and the weights might well change.&quot;</span>, </a>
<a class="sourceLine" id="cb142-9" data-line-number="9">       <span class="dt">y =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb142-10" data-line-number="10"><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb142-11" data-line-number="11"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.ticks.y =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="02_files/figure-html/unnamed-chunk-82-1.png" width="576" /></p>
<p>You could, of course, do all this with the LOO.</p>
</div>
<div id="assumptions-for-interpretation-and-statistical-inference" class="section level2">
<h2><span class="header-section-number">2.8</span> Assumptions for interpretation and statistical inference</h2>
<blockquote>
<p>Regression is a handy tool to have in your statistical toolbox. Its utility as a “general data analytic system” (<a href="https://pdfs.semanticscholar.org/c5f7/8049809e4112ec5feecea20ab2099a03e59c.pdf">Cohen, 1968</a>) will be apparent throughout this book. But it is a human invention that isn’t perfect, it can lead you astray if used indiscriminately, and it is founded on some assumptions that aren’t always realistic or likely to be met in the circumstances in which the method is applied. (p. 68)</p>
</blockquote>
<div id="linearity." class="section level3">
<h3><span class="header-section-number">2.8.1</span> Linearity.</h3>
<p>“When using OLS regression to model some consequent variable of interest <span class="math inline">\(Y\)</span>, you must be willing to assume that the relationship between the variables in the model are linear in nature, or at least approximately linear” (p. 69)</p>
</div>
<div id="normality." class="section level3">
<h3><span class="header-section-number">2.8.2</span> Normality.</h3>
<p>The <strong>brms</strong> package is quite general and allows users to fit models from a variety of likelihoods other than the Gaussian. For example, users can accommodate outliers/extreme values with <a href="https://solomonkurz.netlify.com/post/robust-linear-regression-with-the-robust-student-s-t-distribution/">Student’s t regression</a>. You can do count regression with the Poisson or the negative binomial… For more, see McElreath’s lecture <a href="https://www.youtube.com/watch?v=DyrUkqK9Tj4&amp;t=254s&amp;frags=pl%2Cwn">introducing the generalized linear model</a> or Bürkner’s vignette, <a href="https://cran.r-project.org/web/packages/brms/vignettes/brms_families.html"><em>Parameterization of Response Distributions in brms</em></a></p>
</div>
<div id="homoscedasticity." class="section level3">
<h3><span class="header-section-number">2.8.3</span> Homoscedasticity.</h3>
<p>The <strong>brms</strong> package can also accommodate homoscedasticity with distributional modeling. In short, one simply models <span class="math inline">\(\sigma\)</span> in addition to the mean, <span class="math inline">\(\mu\)</span>. See Bürkner’s <a href="https://cran.r-project.org/web/packages/brms/vignettes/brms_distreg.html">handy vignette</a> on the topic.</p>
</div>
<div id="independence." class="section level3">
<h3><span class="header-section-number">2.8.4</span> Independence.</h3>
<p>The issue of independence is where the multilevel model comes on. See any relevant text, such as <a href="http://xcelab.net/rm/statistical-rethinking/"><em>Statistical Rethinking</em></a> or <a href="http://www.stat.columbia.edu/~gelman/arm/"><em>Data Analysis Using Regression and Multilevel/Hierarchical Models</em></a>. And yes, <strong>brms</strong> is fully capable of handling multilevel models (see <a href="https://cran.r-project.org/web/packages/brms/vignettes/brms_overview.pdf">here</a> or <a href="https://cran.r-project.org/web/packages/brms/vignettes/brms_multilevel.pdf">here</a>).</p>
</div>
</div>
<div id="reference" class="section level2 unnumbered">
<h2>Reference</h2>
<p><a href="http://afhayes.com/introduction-to-mediation-moderation-and-conditional-process-analysis.html">Hayes, A. F. (2018). <em>Introduction to mediation, moderation, and conditional process analysis: A regression-based approach.</em> (2nd ed.). New York, NY, US: The Guilford Press.</a></p>
</div>
<div id="session-info-1" class="section level2 unnumbered">
<h2>Session info</h2>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb143-1" data-line-number="1"><span class="kw">sessionInfo</span>()</a></code></pre></div>
<pre><code>## R version 3.6.0 (2019-04-26)
## Platform: x86_64-apple-darwin15.6.0 (64-bit)
## Running under: macOS High Sierra 10.13.6
## 
## Matrix products: default
## BLAS:   /Library/Frameworks/R.framework/Versions/3.6/Resources/lib/libRblas.0.dylib
## LAPACK: /Library/Frameworks/R.framework/Versions/3.6/Resources/lib/libRlapack.dylib
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
##  [1] HDInterval_0.2.0 brms_2.10.3      Rcpp_1.0.2       forcats_0.4.0    stringr_1.4.0    dplyr_0.8.3     
##  [7] purrr_0.3.3      readr_1.3.1      tidyr_1.0.0      tibble_2.1.3     ggplot2_3.2.1    tidyverse_1.2.1 
## 
## loaded via a namespace (and not attached):
##  [1] nlme_3.1-139         matrixStats_0.55.0   xts_0.11-2           lubridate_1.7.4      threejs_0.3.1       
##  [6] httr_1.4.0           rstan_2.19.2         tools_3.6.0          backports_1.1.5      utf8_1.1.4          
## [11] R6_2.4.0             DT_0.9               lazyeval_0.2.2       colorspace_1.4-1     withr_2.1.2         
## [16] mnormt_1.5-5         prettyunits_1.0.2    processx_3.4.1       tidyselect_0.2.5     gridExtra_2.3       
## [21] Brobdingnag_1.2-6    compiler_3.6.0       cli_1.1.0            rvest_0.3.4          xml2_1.2.0          
## [26] shinyjs_1.0          labeling_0.3         colourpicker_1.0     scales_1.0.0         dygraphs_1.1.1.6    
## [31] psych_1.8.12         callr_3.3.2          ggridges_0.5.1       StanHeaders_2.19.0   digest_0.6.21       
## [36] foreign_0.8-71       rmarkdown_1.13       base64enc_0.1-3      pkgconfig_2.0.3      htmltools_0.4.0     
## [41] htmlwidgets_1.5      rlang_0.4.1          readxl_1.3.1         rstudioapi_0.10      shiny_1.3.2         
## [46] generics_0.0.2       zoo_1.8-6            jsonlite_1.6         crosstalk_1.0.0      gtools_3.8.1        
## [51] inline_0.3.15        magrittr_1.5         loo_2.1.0            bayesplot_1.7.0      Matrix_1.2-17       
## [56] munsell_0.5.0        fansi_0.4.0          abind_1.4-5          lifecycle_0.1.0      stringi_1.4.3       
## [61] pkgbuild_1.0.5       plyr_1.8.4           grid_3.6.0           parallel_3.6.0       promises_1.1.0      
## [66] crayon_1.3.4         miniUI_0.1.1.1       lattice_0.20-38      haven_2.1.0          hms_0.4.2           
## [71] ps_1.3.0             zeallot_0.1.0        knitr_1.23           pillar_1.4.2         igraph_1.2.4.1      
## [76] markdown_1.1         shinystan_2.5.0      stats4_3.6.0         reshape2_1.4.3       rstantools_2.0.0    
## [81] glue_1.3.1.9000      evaluate_0.14        modelr_0.1.4         vctrs_0.2.0          httpuv_1.5.2        
## [86] cellranger_1.1.0     gtable_0.3.0         assertthat_0.2.1     xfun_0.10            mime_0.7            
## [91] xtable_1.8-4         broom_0.5.2          coda_0.19-3          later_1.0.0          rsconnect_0.8.15    
## [96] shinythemes_1.1.2    ellipsis_0.3.0       bridgesampling_0.7-2</code></pre>
</div>
<div id="footnote" class="section level2 unnumbered">
<h2>Footnote</h2>

</div>
</div>



<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p>Hayes did not cover count regression with the Poisson likelihood in this textbook. If you’d like to learn more, one place to start is with <a href="https://www.youtube.com/watch?v=hRJtKCIDTwc">McElreath’s lecture on binomial and Poisson models</a>.<a href="fundamentals-of-linear-regression.html#fnref1" class="footnote-back">↩</a></p></li>
<li id="fn2"><p>We will not be covering structural equation modeling (SEM) in this project. If you’re interested, you might check out <a href="https://www.youtube.com/playlist?list=PLw93TUuxrFAZkJVc5dhgTZpOT7qmTjlT7">this video series</a> by Erin M. Buchanan on SEM within <strong>R</strong>, particularly with the handy <a href="http://lavaan.ugent.be/"><strong>lavaan</strong></a> package.<a href="fundamentals-of-linear-regression.html#fnref2" class="footnote-back">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="introduction.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="the-simple-mediation-model.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
